"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = useTrackException;

var _react = require("react");

var _createCustomEvent = _interopRequireDefault(require("../utils/createCustomEvent"));

var _useReadTelemetryDimensions = _interopRequireDefault(require("./internal/useReadTelemetryDimensions"));

var _useWebChatAPIContext2 = _interopRequireDefault(require("./internal/useWebChatAPIContext"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function useTrackException() {
  var _useWebChatAPIContext = (0, _useWebChatAPIContext2.default)(),
      onTelemetry = _useWebChatAPIContext.onTelemetry;

  var readTelemetryDimensions = (0, _useReadTelemetryDimensions.default)();
  return (0, _react.useCallback)(function (error) {
    var fatal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

    if (!(error instanceof Error)) {
      return console.warn('botframework-webchat: "error" passed to "useTrackException" must be specified and of type Error.');
    }

    onTelemetry && onTelemetry((0, _createCustomEvent.default)('exception', {
      dimensions: _objectSpread({}, readTelemetryDimensions()),
      error: error,
      fatal: !!fatal
    }));
  }, [onTelemetry, readTelemetryDimensions]);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9ob29rcy91c2VUcmFja0V4Y2VwdGlvbi50cyJdLCJuYW1lcyI6WyJ1c2VUcmFja0V4Y2VwdGlvbiIsIm9uVGVsZW1ldHJ5IiwicmVhZFRlbGVtZXRyeURpbWVuc2lvbnMiLCJlcnJvciIsImZhdGFsIiwiRXJyb3IiLCJjb25zb2xlIiwid2FybiIsImRpbWVuc2lvbnMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7OztBQUVlLFNBQVNBLGlCQUFULEdBQXFFO0FBQ2xGLDhCQUF3QixxQ0FBeEI7QUFBQSxNQUFRQyxXQUFSLHlCQUFRQSxXQUFSOztBQUNBLE1BQU1DLHVCQUF1QixHQUFHLDBDQUFoQztBQUVBLFNBQU8sd0JBQ0wsVUFBQ0MsS0FBRCxFQUF5QjtBQUFBLFFBQWpCQyxLQUFpQix1RUFBVCxJQUFTOztBQUN2QixRQUFJLEVBQUVELEtBQUssWUFBWUUsS0FBbkIsQ0FBSixFQUErQjtBQUM3QixhQUFPQyxPQUFPLENBQUNDLElBQVIsQ0FDTCxrR0FESyxDQUFQO0FBR0Q7O0FBRUROLElBQUFBLFdBQVcsSUFDVEEsV0FBVyxDQUNULGdDQUFrQixXQUFsQixFQUErQjtBQUM3Qk8sTUFBQUEsVUFBVSxvQkFBT04sdUJBQXVCLEVBQTlCLENBRG1CO0FBRTdCQyxNQUFBQSxLQUFLLEVBQUxBLEtBRjZCO0FBRzdCQyxNQUFBQSxLQUFLLEVBQUUsQ0FBQyxDQUFDQTtBQUhvQixLQUEvQixDQURTLENBRGI7QUFRRCxHQWhCSSxFQWlCTCxDQUFDSCxXQUFELEVBQWNDLHVCQUFkLENBakJLLENBQVA7QUFtQkQiLCJzb3VyY2VSb290IjoiY29tcG9uZW50Oi8vLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgY3JlYXRlQ3VzdG9tRXZlbnQgZnJvbSAnLi4vdXRpbHMvY3JlYXRlQ3VzdG9tRXZlbnQnO1xuaW1wb3J0IHVzZVJlYWRUZWxlbWV0cnlEaW1lbnNpb25zIGZyb20gJy4vaW50ZXJuYWwvdXNlUmVhZFRlbGVtZXRyeURpbWVuc2lvbnMnO1xuaW1wb3J0IHVzZVdlYkNoYXRBUElDb250ZXh0IGZyb20gJy4vaW50ZXJuYWwvdXNlV2ViQ2hhdEFQSUNvbnRleHQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VUcmFja0V4Y2VwdGlvbigpOiAoZXJyb3I6IEVycm9yLCBmYXRhbDogYm9vbGVhbikgPT4gdm9pZCB7XG4gIGNvbnN0IHsgb25UZWxlbWV0cnkgfSA9IHVzZVdlYkNoYXRBUElDb250ZXh0KCk7XG4gIGNvbnN0IHJlYWRUZWxlbWV0cnlEaW1lbnNpb25zID0gdXNlUmVhZFRlbGVtZXRyeURpbWVuc2lvbnMoKTtcblxuICByZXR1cm4gdXNlQ2FsbGJhY2soXG4gICAgKGVycm9yLCBmYXRhbCA9IHRydWUpID0+IHtcbiAgICAgIGlmICghKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpKSB7XG4gICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oXG4gICAgICAgICAgJ2JvdGZyYW1ld29yay13ZWJjaGF0OiBcImVycm9yXCIgcGFzc2VkIHRvIFwidXNlVHJhY2tFeGNlcHRpb25cIiBtdXN0IGJlIHNwZWNpZmllZCBhbmQgb2YgdHlwZSBFcnJvci4nXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIG9uVGVsZW1ldHJ5ICYmXG4gICAgICAgIG9uVGVsZW1ldHJ5KFxuICAgICAgICAgIGNyZWF0ZUN1c3RvbUV2ZW50KCdleGNlcHRpb24nLCB7XG4gICAgICAgICAgICBkaW1lbnNpb25zOiB7IC4uLnJlYWRUZWxlbWV0cnlEaW1lbnNpb25zKCkgfSxcbiAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgZmF0YWw6ICEhZmF0YWxcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH0sXG4gICAgW29uVGVsZW1ldHJ5LCByZWFkVGVsZW1ldHJ5RGltZW5zaW9uc11cbiAgKTtcbn1cbiJdfQ==