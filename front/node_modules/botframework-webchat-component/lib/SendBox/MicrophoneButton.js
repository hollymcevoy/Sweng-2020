"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.connectMicrophoneButton = void 0;
exports.useMicrophoneButtonClick = useMicrophoneButtonClick;
exports.useMicrophoneButtonDisabled = useMicrophoneButtonDisabled;

var _botframeworkWebchatCore = require("botframework-webchat-core");

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _classnames = _interopRequireDefault(require("classnames"));

var _memoizeOne = _interopRequireDefault(require("memoize-one"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireWildcard(require("react"));

var _connectToWebChat = _interopRequireDefault(require("../connectToWebChat"));

var _IconButton = _interopRequireDefault(require("./IconButton"));

var _MicrophoneIcon = _interopRequireDefault(require("./Assets/MicrophoneIcon"));

var _useDictateAbortable3 = _interopRequireDefault(require("../hooks/useDictateAbortable"));

var _useStyleSet3 = _interopRequireDefault(require("../hooks/useStyleSet"));

var _useStyleToEmotionObject = _interopRequireDefault(require("../hooks/internal/useStyleToEmotionObject"));

var _useWebSpeechPonyfill3 = _interopRequireDefault(require("../hooks/useWebSpeechPonyfill"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var DictateState = _botframeworkWebchatCore.Constants.DictateState;
var useDictateInterims = _botframeworkWebchatApi.hooks.useDictateInterims,
    useDictateState = _botframeworkWebchatApi.hooks.useDictateState,
    useDisabled = _botframeworkWebchatApi.hooks.useDisabled,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer,
    useSendBoxValue = _botframeworkWebchatApi.hooks.useSendBoxValue,
    useShouldSpeakIncomingActivity = _botframeworkWebchatApi.hooks.useShouldSpeakIncomingActivity,
    useStartDictate = _botframeworkWebchatApi.hooks.useStartDictate,
    useStopDictate = _botframeworkWebchatApi.hooks.useStopDictate;
var ROOT_STYLE = {
  display: 'flex',
  // .sr-only - This component is intended to be invisible to the visual Web Chat user, but read by the AT when using a screen reader
  '& > .sr-only': {
    color: 'transparent',
    height: 1,
    left: -10000,
    overflow: 'hidden',
    position: 'absolute',
    top: 0,
    whiteSpace: 'nowrap',
    width: 1
  }
};

var connectMicrophoneButton = function connectMicrophoneButton() {
  var primeSpeechSynthesis = (0, _memoizeOne.default)(function (speechSynthesis, SpeechSynthesisUtterance) {
    if (speechSynthesis && SpeechSynthesisUtterance) {
      var utterance = new SpeechSynthesisUtterance('');

      var _speechSynthesis$getV = speechSynthesis.getVoices();

      var _speechSynthesis$getV2 = _slicedToArray(_speechSynthesis$getV, 1);

      utterance.voice = _speechSynthesis$getV2[0];
      speechSynthesis.speak(utterance);
    }
  });

  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {
    selectors[_key] = arguments[_key];
  }

  return _connectToWebChat.default.apply(void 0, [function (_ref) {
    var disabled = _ref.disabled,
        dictateInterims = _ref.dictateInterims,
        dictateState = _ref.dictateState,
        language = _ref.language,
        setSendBox = _ref.setSendBox,
        startDictate = _ref.startDictate,
        stopDictate = _ref.stopDictate,
        stopSpeakingActivity = _ref.stopSpeakingActivity,
        webSpeechPonyfill = _ref.webSpeechPonyfill;

    var _ref2 = webSpeechPonyfill || {},
        speechSynthesis = _ref2.speechSynthesis,
        SpeechSynthesisUtterance = _ref2.SpeechSynthesisUtterance;

    return {
      click: function click() {
        if (dictateState === DictateState.WILL_START) {
          stopSpeakingActivity();
        } else if (dictateState === DictateState.DICTATING) {
          stopDictate();
          setSendBox(dictateInterims.join(' '));
        } else {
          stopSpeakingActivity();
          startDictate();
        }

        primeSpeechSynthesis(speechSynthesis, SpeechSynthesisUtterance);
      },
      dictating: dictateState === DictateState.DICTATING,
      disabled: disabled || dictateState === DictateState.STARTING && dictateState === DictateState.STOPPING,
      language: language
    };
  }].concat(selectors));
};

exports.connectMicrophoneButton = connectMicrophoneButton;

function useMicrophoneButtonClick() {
  var _useSendBoxValue = useSendBoxValue(),
      _useSendBoxValue2 = _slicedToArray(_useSendBoxValue, 2),
      setSendBox = _useSendBoxValue2[1];

  var _useShouldSpeakIncomi = useShouldSpeakIncomingActivity(),
      _useShouldSpeakIncomi2 = _slicedToArray(_useShouldSpeakIncomi, 2),
      setShouldSpeakIncomingActivity = _useShouldSpeakIncomi2[1];

  var _useDictateInterims = useDictateInterims(),
      _useDictateInterims2 = _slicedToArray(_useDictateInterims, 1),
      dictateInterims = _useDictateInterims2[0];

  var _useDictateState = useDictateState(),
      _useDictateState2 = _slicedToArray(_useDictateState, 1),
      dictateState = _useDictateState2[0];

  var _useWebSpeechPonyfill = (0, _useWebSpeechPonyfill3.default)(),
      _useWebSpeechPonyfill2 = _slicedToArray(_useWebSpeechPonyfill, 1),
      webSpeechPonyfill = _useWebSpeechPonyfill2[0];

  var startDictate = useStartDictate();
  var stopDictate = useStopDictate();

  var _ref3 = webSpeechPonyfill || {},
      speechSynthesis = _ref3.speechSynthesis,
      SpeechSynthesisUtterance = _ref3.SpeechSynthesisUtterance;

  var _useState = (0, _react.useState)(function () {
    return (0, _memoizeOne.default)(function (speechSynthesis, SpeechSynthesisUtterance) {
      if (speechSynthesis && SpeechSynthesisUtterance) {
        var utterance = new SpeechSynthesisUtterance('');

        var _speechSynthesis$getV3 = speechSynthesis.getVoices();

        var _speechSynthesis$getV4 = _slicedToArray(_speechSynthesis$getV3, 1);

        utterance.voice = _speechSynthesis$getV4[0];
        speechSynthesis.speak(utterance);
      }
    });
  }),
      _useState2 = _slicedToArray(_useState, 1),
      primeSpeechSynthesis = _useState2[0]; // TODO: [P2] We should revisit this function later
  //       The click() logic seems local to the component, but may not be generalized across all implementations.


  return (0, _react.useCallback)(function () {
    if (dictateState === DictateState.WILL_START) {
      setShouldSpeakIncomingActivity(false);
    } else if (dictateState === DictateState.DICTATING) {
      stopDictate();
      setSendBox(dictateInterims.join(' '));
    } else {
      setShouldSpeakIncomingActivity(false);
      startDictate();
    }

    primeSpeechSynthesis(speechSynthesis, SpeechSynthesisUtterance);
  }, [dictateInterims, dictateState, primeSpeechSynthesis, setSendBox, setShouldSpeakIncomingActivity, speechSynthesis, SpeechSynthesisUtterance, startDictate, stopDictate]);
}

function useMicrophoneButtonDisabled() {
  var _useDictateAbortable = (0, _useDictateAbortable3.default)(),
      _useDictateAbortable2 = _slicedToArray(_useDictateAbortable, 1),
      abortable = _useDictateAbortable2[0];

  var _useDictateState3 = useDictateState(),
      _useDictateState4 = _slicedToArray(_useDictateState3, 1),
      dictateState = _useDictateState4[0];

  var _useDisabled = useDisabled(),
      _useDisabled2 = _slicedToArray(_useDisabled, 1),
      disabled = _useDisabled2[0];

  return [disabled || dictateState === DictateState.STARTING || dictateState === DictateState.STOPPING || dictateState === DictateState.DICTATING && !abortable];
}

var MicrophoneButton = function MicrophoneButton(_ref4) {
  var className = _ref4.className;

  var _useStyleSet = (0, _useStyleSet3.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      microphoneButtonStyleSet = _useStyleSet2[0].microphoneButton;

  var _useDictateState5 = useDictateState(),
      _useDictateState6 = _slicedToArray(_useDictateState5, 1),
      dictateState = _useDictateState6[0];

  var _useMicrophoneButtonD = useMicrophoneButtonDisabled(),
      _useMicrophoneButtonD2 = _slicedToArray(_useMicrophoneButtonD, 1),
      disabled = _useMicrophoneButtonD2[0];

  var click = useMicrophoneButtonClick();
  var localize = useLocalizer();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var dictating = dictateState === DictateState.DICTATING;
  return /*#__PURE__*/_react.default.createElement("div", {
    "aria-controls": "webchatSendBoxMicrophoneButton",
    className: (0, _classnames.default)('webchat__microphone-button', {
      'webchat__microphone-button--dictating': dictating
    }, microphoneButtonStyleSet + '', rootClassName, (className || '') + '')
  }, /*#__PURE__*/_react.default.createElement(_IconButton.default, {
    alt: localize('TEXT_INPUT_SPEAK_BUTTON_ALT'),
    className: "webchat__microphone-button__button",
    disabled: disabled,
    onClick: click
  }, /*#__PURE__*/_react.default.createElement(_MicrophoneIcon.default, {
    className: "webchat__microphone-button__icon"
  })), /*#__PURE__*/_react.default.createElement("div", {
    "aria-live": "polite",
    className: "sr-only",
    id: "webchatSendBoxMicrophoneButton",
    role: "status"
  }, localize(dictating ? 'SPEECH_INPUT_MICROPHONE_BUTTON_OPEN_ALT' : 'SPEECH_INPUT_MICROPHONE_BUTTON_CLOSE_ALT')));
};

MicrophoneButton.defaultProps = {
  className: ''
};
MicrophoneButton.propTypes = {
  className: _propTypes.default.string
};
var _default = MicrophoneButton;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TZW5kQm94L01pY3JvcGhvbmVCdXR0b24udHN4Il0sIm5hbWVzIjpbIkRpY3RhdGVTdGF0ZSIsIkNvbnN0YW50cyIsInVzZURpY3RhdGVJbnRlcmltcyIsImhvb2tzIiwidXNlRGljdGF0ZVN0YXRlIiwidXNlRGlzYWJsZWQiLCJ1c2VMb2NhbGl6ZXIiLCJ1c2VTZW5kQm94VmFsdWUiLCJ1c2VTaG91bGRTcGVha0luY29taW5nQWN0aXZpdHkiLCJ1c2VTdGFydERpY3RhdGUiLCJ1c2VTdG9wRGljdGF0ZSIsIlJPT1RfU1RZTEUiLCJkaXNwbGF5IiwiY29sb3IiLCJoZWlnaHQiLCJsZWZ0Iiwib3ZlcmZsb3ciLCJwb3NpdGlvbiIsInRvcCIsIndoaXRlU3BhY2UiLCJ3aWR0aCIsImNvbm5lY3RNaWNyb3Bob25lQnV0dG9uIiwicHJpbWVTcGVlY2hTeW50aGVzaXMiLCJzcGVlY2hTeW50aGVzaXMiLCJTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UiLCJ1dHRlcmFuY2UiLCJnZXRWb2ljZXMiLCJ2b2ljZSIsInNwZWFrIiwic2VsZWN0b3JzIiwiY29ubmVjdFRvV2ViQ2hhdCIsImRpc2FibGVkIiwiZGljdGF0ZUludGVyaW1zIiwiZGljdGF0ZVN0YXRlIiwibGFuZ3VhZ2UiLCJzZXRTZW5kQm94Iiwic3RhcnREaWN0YXRlIiwic3RvcERpY3RhdGUiLCJzdG9wU3BlYWtpbmdBY3Rpdml0eSIsIndlYlNwZWVjaFBvbnlmaWxsIiwiY2xpY2siLCJXSUxMX1NUQVJUIiwiRElDVEFUSU5HIiwiam9pbiIsImRpY3RhdGluZyIsIlNUQVJUSU5HIiwiU1RPUFBJTkciLCJ1c2VNaWNyb3Bob25lQnV0dG9uQ2xpY2siLCJzZXRTaG91bGRTcGVha0luY29taW5nQWN0aXZpdHkiLCJ1c2VNaWNyb3Bob25lQnV0dG9uRGlzYWJsZWQiLCJhYm9ydGFibGUiLCJNaWNyb3Bob25lQnV0dG9uIiwiY2xhc3NOYW1lIiwibWljcm9waG9uZUJ1dHRvblN0eWxlU2V0IiwibWljcm9waG9uZUJ1dHRvbiIsImxvY2FsaXplIiwicm9vdENsYXNzTmFtZSIsImRlZmF1bHRQcm9wcyIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFRQSxZQUFSLEdBQXlCQyxrQ0FBekIsQ0FBUUQsWUFBUjtBQUVBLElBQ0VFLGtCQURGLEdBU0lDLDZCQVRKLENBQ0VELGtCQURGO0FBQUEsSUFFRUUsZUFGRixHQVNJRCw2QkFUSixDQUVFQyxlQUZGO0FBQUEsSUFHRUMsV0FIRixHQVNJRiw2QkFUSixDQUdFRSxXQUhGO0FBQUEsSUFJRUMsWUFKRixHQVNJSCw2QkFUSixDQUlFRyxZQUpGO0FBQUEsSUFLRUMsZUFMRixHQVNJSiw2QkFUSixDQUtFSSxlQUxGO0FBQUEsSUFNRUMsOEJBTkYsR0FTSUwsNkJBVEosQ0FNRUssOEJBTkY7QUFBQSxJQU9FQyxlQVBGLEdBU0lOLDZCQVRKLENBT0VNLGVBUEY7QUFBQSxJQVFFQyxjQVJGLEdBU0lQLDZCQVRKLENBUUVPLGNBUkY7QUFXQSxJQUFNQyxVQUFVLEdBQUc7QUFDakJDLEVBQUFBLE9BQU8sRUFBRSxNQURRO0FBR2pCO0FBRUEsa0JBQWdCO0FBQ2RDLElBQUFBLEtBQUssRUFBRSxhQURPO0FBRWRDLElBQUFBLE1BQU0sRUFBRSxDQUZNO0FBR2RDLElBQUFBLElBQUksRUFBRSxDQUFDLEtBSE87QUFJZEMsSUFBQUEsUUFBUSxFQUFFLFFBSkk7QUFLZEMsSUFBQUEsUUFBUSxFQUFFLFVBTEk7QUFNZEMsSUFBQUEsR0FBRyxFQUFFLENBTlM7QUFPZEMsSUFBQUEsVUFBVSxFQUFFLFFBUEU7QUFRZEMsSUFBQUEsS0FBSyxFQUFFO0FBUk87QUFMQyxDQUFuQjs7QUFpQkEsSUFBTUMsdUJBQXVCLEdBQUcsU0FBMUJB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QU8sRUFBRVM7QUFKWCxrQkFNRSw2QkFBQyx1QkFBRDtBQUFnQixJQUFBLFNBQVMsRUFBQztBQUExQixJQU5GLENBVkYsZUFrQkU7QUFBSyxpQkFBVSxRQUFmO0FBQXdCLElBQUEsU0FBUyxFQUFDLFNBQWxDO0FBQTRDLElBQUEsRUFBRSxFQUFDLGdDQUEvQztBQUFnRixJQUFBLElBQUksRUFBQztBQUFyRixLQUNHZSxRQUFRLENBQUNYLFNBQVMsR0FBRyx5Q0FBSCxHQUErQywwQ0FBekQsQ0FEWCxDQWxCRixDQURGO0FBd0JELENBbENEOztBQW9DQU8sZ0JBQWdCLENBQUNNLFlBQWpCLEdBQWdDO0FBQzlCTCxFQUFBQSxTQUFTLEVBQUU7QUFEbUIsQ0FBaEM7QUFJQUQsZ0JBQWdCLENBQUNPLFNBQWpCLEdBQTZCO0FBQzNCTixFQUFBQSxTQUFTLEVBQUVPLG1CQUFVQztBQURNLENBQTdCO2VBSWVULGdCIiwic291cmNlUm9vdCI6ImNvbXBvbmVudDovLy8iLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGlzIGlzIHJlcXVpcmVkIGZvciBhcmlhLWNvbnRyb2xzLlxuLyogZXNsaW50IHJlYWN0L2ZvcmJpZC1kb20tcHJvcHM6IFwib2ZmXCIgKi9cblxuaW1wb3J0IHsgQ29uc3RhbnRzIH0gZnJvbSAnYm90ZnJhbWV3b3JrLXdlYmNoYXQtY29yZSc7XG5pbXBvcnQgeyBob29rcyB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWFwaSc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBtZW1vaXplIGZyb20gJ21lbW9pemUtb25lJztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3QsIHsgRkMsIHVzZUNhbGxiYWNrLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IGNvbm5lY3RUb1dlYkNoYXQgZnJvbSAnLi4vY29ubmVjdFRvV2ViQ2hhdCc7XG5pbXBvcnQgSWNvbkJ1dHRvbiBmcm9tICcuL0ljb25CdXR0b24nO1xuaW1wb3J0IE1pY3JvcGhvbmVJY29uIGZyb20gJy4vQXNzZXRzL01pY3JvcGhvbmVJY29uJztcbmltcG9ydCB1c2VEaWN0YXRlQWJvcnRhYmxlIGZyb20gJy4uL2hvb2tzL3VzZURpY3RhdGVBYm9ydGFibGUnO1xuaW1wb3J0IHVzZVN0eWxlU2V0IGZyb20gJy4uL2hvb2tzL3VzZVN0eWxlU2V0JztcbmltcG9ydCB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCBmcm9tICcuLi9ob29rcy9pbnRlcm5hbC91c2VTdHlsZVRvRW1vdGlvbk9iamVjdCc7XG5pbXBvcnQgdXNlV2ViU3BlZWNoUG9ueWZpbGwgZnJvbSAnLi4vaG9va3MvdXNlV2ViU3BlZWNoUG9ueWZpbGwnO1xuXG5jb25zdCB7IERpY3RhdGVTdGF0ZSB9ID0gQ29uc3RhbnRzO1xuXG5jb25zdCB7XG4gIHVzZURpY3RhdGVJbnRlcmltcyxcbiAgdXNlRGljdGF0ZVN0YXRlLFxuICB1c2VEaXNhYmxlZCxcbiAgdXNlTG9jYWxpemVyLFxuICB1c2VTZW5kQm94VmFsdWUsXG4gIHVzZVNob3VsZFNwZWFrSW5jb21pbmdBY3Rpdml0eSxcbiAgdXNlU3RhcnREaWN0YXRlLFxuICB1c2VTdG9wRGljdGF0ZVxufSA9IGhvb2tzO1xuXG5jb25zdCBST09UX1NUWUxFID0ge1xuICBkaXNwbGF5OiAnZmxleCcsXG5cbiAgLy8gLnNyLW9ubHkgLSBUaGlzIGNvbXBvbmVudCBpcyBpbnRlbmRlZCB0byBiZSBpbnZpc2libGUgdG8gdGhlIHZpc3VhbCBXZWIgQ2hhdCB1c2VyLCBidXQgcmVhZCBieSB0aGUgQVQgd2hlbiB1c2luZyBhIHNjcmVlbiByZWFkZXJcblxuICAnJiA+IC5zci1vbmx5Jzoge1xuICAgIGNvbG9yOiAndHJhbnNwYXJlbnQnLFxuICAgIGhlaWdodDogMSxcbiAgICBsZWZ0OiAtMTAwMDAsXG4gICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHRvcDogMCxcbiAgICB3aGl0ZVNwYWNlOiAnbm93cmFwJyxcbiAgICB3aWR0aDogMVxuICB9XG59O1xuXG5jb25zdCBjb25uZWN0TWljcm9waG9uZUJ1dHRvbiA9ICguLi5zZWxlY3RvcnMpID0+IHtcbiAgY29uc3QgcHJpbWVTcGVlY2hTeW50aGVzaXMgPSBtZW1vaXplKChzcGVlY2hTeW50aGVzaXMsIFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSkgPT4ge1xuICAgIGlmIChzcGVlY2hTeW50aGVzaXMgJiYgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKSB7XG4gICAgICBjb25zdCB1dHRlcmFuY2UgPSBuZXcgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKCcnKTtcblxuICAgICAgW3V0dGVyYW5jZS52b2ljZV0gPSBzcGVlY2hTeW50aGVzaXMuZ2V0Vm9pY2VzKCk7XG4gICAgICBzcGVlY2hTeW50aGVzaXMuc3BlYWsodXR0ZXJhbmNlKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBjb25uZWN0VG9XZWJDaGF0KFxuICAgICh7XG4gICAgICBkaXNhYmxlZCxcbiAgICAgIGRpY3RhdGVJbnRlcmltcyxcbiAgICAgIGRpY3RhdGVTdGF0ZSxcbiAgICAgIGxhbmd1YWdlLFxuICAgICAgc2V0U2VuZEJveCxcbiAgICAgIHN0YXJ0RGljdGF0ZSxcbiAgICAgIHN0b3BEaWN0YXRlLFxuICAgICAgc3RvcFNwZWFraW5nQWN0aXZpdHksXG4gICAgICB3ZWJTcGVlY2hQb255ZmlsbFxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IHsgc3BlZWNoU3ludGhlc2lzLCBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UgfSA9IHdlYlNwZWVjaFBvbnlmaWxsIHx8IHt9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjbGljazogKCkgPT4ge1xuICAgICAgICAgIGlmIChkaWN0YXRlU3RhdGUgPT09IERpY3RhdGVTdGF0ZS5XSUxMX1NUQVJUKSB7XG4gICAgICAgICAgICBzdG9wU3BlYWtpbmdBY3Rpdml0eSgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZGljdGF0ZVN0YXRlID09PSBEaWN0YXRlU3RhdGUuRElDVEFUSU5HKSB7XG4gICAgICAgICAgICBzdG9wRGljdGF0ZSgpO1xuICAgICAgICAgICAgc2V0U2VuZEJveChkaWN0YXRlSW50ZXJpbXMuam9pbignICcpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RvcFNwZWFraW5nQWN0aXZpdHkoKTtcbiAgICAgICAgICAgIHN0YXJ0RGljdGF0ZSgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHByaW1lU3BlZWNoU3ludGhlc2lzKHNwZWVjaFN5bnRoZXNpcywgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGljdGF0aW5nOiBkaWN0YXRlU3RhdGUgPT09IERpY3RhdGVTdGF0ZS5ESUNUQVRJTkcsXG4gICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZCB8fCAoZGljdGF0ZVN0YXRlID09PSBEaWN0YXRlU3RhdGUuU1RBUlRJTkcgJiYgZGljdGF0ZVN0YXRlID09PSBEaWN0YXRlU3RhdGUuU1RPUFBJTkcpLFxuICAgICAgICBsYW5ndWFnZVxuICAgICAgfTtcbiAgICB9LFxuICAgIC4uLnNlbGVjdG9yc1xuICApO1xufTtcblxuZnVuY3Rpb24gdXNlTWljcm9waG9uZUJ1dHRvbkNsaWNrKCk6ICgpID0+IHZvaWQge1xuICBjb25zdCBbLCBzZXRTZW5kQm94XSA9IHVzZVNlbmRCb3hWYWx1ZSgpO1xuICBjb25zdCBbLCBzZXRTaG91bGRTcGVha0luY29taW5nQWN0aXZpdHldID0gdXNlU2hvdWxkU3BlYWtJbmNvbWluZ0FjdGl2aXR5KCk7XG4gIGNvbnN0IFtkaWN0YXRlSW50ZXJpbXNdID0gdXNlRGljdGF0ZUludGVyaW1zKCk7XG4gIGNvbnN0IFtkaWN0YXRlU3RhdGVdID0gdXNlRGljdGF0ZVN0YXRlKCk7XG4gIGNvbnN0IFt3ZWJTcGVlY2hQb255ZmlsbF0gPSB1c2VXZWJTcGVlY2hQb255ZmlsbCgpO1xuICBjb25zdCBzdGFydERpY3RhdGUgPSB1c2VTdGFydERpY3RhdGUoKTtcbiAgY29uc3Qgc3RvcERpY3RhdGUgPSB1c2VTdG9wRGljdGF0ZSgpO1xuXG4gIGNvbnN0IHsgc3BlZWNoU3ludGhlc2lzLCBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UgfSA9IHdlYlNwZWVjaFBvbnlmaWxsIHx8IHt9O1xuXG4gIGNvbnN0IFtwcmltZVNwZWVjaFN5bnRoZXNpc10gPSB1c2VTdGF0ZSgoKSA9PlxuICAgIG1lbW9pemUoKHNwZWVjaFN5bnRoZXNpcywgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKSA9PiB7XG4gICAgICBpZiAoc3BlZWNoU3ludGhlc2lzICYmIFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSkge1xuICAgICAgICBjb25zdCB1dHRlcmFuY2UgPSBuZXcgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKCcnKTtcblxuICAgICAgICBbdXR0ZXJhbmNlLnZvaWNlXSA9IHNwZWVjaFN5bnRoZXNpcy5nZXRWb2ljZXMoKTtcbiAgICAgICAgc3BlZWNoU3ludGhlc2lzLnNwZWFrKHV0dGVyYW5jZSk7XG4gICAgICB9XG4gICAgfSlcbiAgKTtcblxuICAvLyBUT0RPOiBbUDJdIFdlIHNob3VsZCByZXZpc2l0IHRoaXMgZnVuY3Rpb24gbGF0ZXJcbiAgLy8gICAgICAgVGhlIGNsaWNrKCkgbG9naWMgc2VlbXMgbG9jYWwgdG8gdGhlIGNvbXBvbmVudCwgYnV0IG1heSBub3QgYmUgZ2VuZXJhbGl6ZWQgYWNyb3NzIGFsbCBpbXBsZW1lbnRhdGlvbnMuXG4gIHJldHVybiB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKGRpY3RhdGVTdGF0ZSA9PT0gRGljdGF0ZVN0YXRlLldJTExfU1RBUlQpIHtcbiAgICAgIHNldFNob3VsZFNwZWFrSW5jb21pbmdBY3Rpdml0eShmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChkaWN0YXRlU3RhdGUgPT09IERpY3RhdGVTdGF0ZS5ESUNUQVRJTkcpIHtcbiAgICAgIHN0b3BEaWN0YXRlKCk7XG4gICAgICBzZXRTZW5kQm94KGRpY3RhdGVJbnRlcmltcy5qb2luKCcgJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRTaG91bGRTcGVha0luY29taW5nQWN0aXZpdHkoZmFsc2UpO1xuICAgICAgc3RhcnREaWN0YXRlKCk7XG4gICAgfVxuXG4gICAgcHJpbWVTcGVlY2hTeW50aGVzaXMoc3BlZWNoU3ludGhlc2lzLCBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UpO1xuICB9LCBbXG4gICAgZGljdGF0ZUludGVyaW1zLFxuICAgIGRpY3RhdGVTdGF0ZSxcbiAgICBwcmltZVNwZWVjaFN5bnRoZXNpcyxcbiAgICBzZXRTZW5kQm94LFxuICAgIHNldFNob3VsZFNwZWFrSW5jb21pbmdBY3Rpdml0eSxcbiAgICBzcGVlY2hTeW50aGVzaXMsXG4gICAgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlLFxuICAgIHN0YXJ0RGljdGF0ZSxcbiAgICBzdG9wRGljdGF0ZVxuICBdKTtcbn1cblxuZnVuY3Rpb24gdXNlTWljcm9waG9uZUJ1dHRvbkRpc2FibGVkKCk6IFtib29sZWFuXSB7XG4gIGNvbnN0IFthYm9ydGFibGVdID0gdXNlRGljdGF0ZUFib3J0YWJsZSgpO1xuICBjb25zdCBbZGljdGF0ZVN0YXRlXSA9IHVzZURpY3RhdGVTdGF0ZSgpO1xuICBjb25zdCBbZGlzYWJsZWRdID0gdXNlRGlzYWJsZWQoKTtcblxuICByZXR1cm4gW1xuICAgIGRpc2FibGVkIHx8XG4gICAgICBkaWN0YXRlU3RhdGUgPT09IERpY3RhdGVTdGF0ZS5TVEFSVElORyB8fFxuICAgICAgZGljdGF0ZVN0YXRlID09PSBEaWN0YXRlU3RhdGUuU1RPUFBJTkcgfHxcbiAgICAgIChkaWN0YXRlU3RhdGUgPT09IERpY3RhdGVTdGF0ZS5ESUNUQVRJTkcgJiYgIWFib3J0YWJsZSlcbiAgXTtcbn1cblxudHlwZSBNaWNyb3Bob25lQnV0dG9uUHJvcHMgPSB7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbn07XG5cbmNvbnN0IE1pY3JvcGhvbmVCdXR0b246IEZDPE1pY3JvcGhvbmVCdXR0b25Qcm9wcz4gPSAoeyBjbGFzc05hbWUgfSkgPT4ge1xuICBjb25zdCBbeyBtaWNyb3Bob25lQnV0dG9uOiBtaWNyb3Bob25lQnV0dG9uU3R5bGVTZXQgfV0gPSB1c2VTdHlsZVNldCgpO1xuICBjb25zdCBbZGljdGF0ZVN0YXRlXSA9IHVzZURpY3RhdGVTdGF0ZSgpO1xuICBjb25zdCBbZGlzYWJsZWRdID0gdXNlTWljcm9waG9uZUJ1dHRvbkRpc2FibGVkKCk7XG4gIGNvbnN0IGNsaWNrID0gdXNlTWljcm9waG9uZUJ1dHRvbkNsaWNrKCk7XG4gIGNvbnN0IGxvY2FsaXplID0gdXNlTG9jYWxpemVyKCk7XG4gIGNvbnN0IHJvb3RDbGFzc05hbWUgPSB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCgpKFJPT1RfU1RZTEUpICsgJyc7XG5cbiAgY29uc3QgZGljdGF0aW5nID0gZGljdGF0ZVN0YXRlID09PSBEaWN0YXRlU3RhdGUuRElDVEFUSU5HO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgYXJpYS1jb250cm9scz1cIndlYmNoYXRTZW5kQm94TWljcm9waG9uZUJ1dHRvblwiXG4gICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoXG4gICAgICAgICd3ZWJjaGF0X19taWNyb3Bob25lLWJ1dHRvbicsXG4gICAgICAgIHsgJ3dlYmNoYXRfX21pY3JvcGhvbmUtYnV0dG9uLS1kaWN0YXRpbmcnOiBkaWN0YXRpbmcgfSxcbiAgICAgICAgbWljcm9waG9uZUJ1dHRvblN0eWxlU2V0ICsgJycsXG4gICAgICAgIHJvb3RDbGFzc05hbWUsXG4gICAgICAgIChjbGFzc05hbWUgfHwgJycpICsgJydcbiAgICAgICl9XG4gICAgPlxuICAgICAgPEljb25CdXR0b25cbiAgICAgICAgYWx0PXtsb2NhbGl6ZSgnVEVYVF9JTlBVVF9TUEVBS19CVVRUT05fQUxUJyl9XG4gICAgICAgIGNsYXNzTmFtZT1cIndlYmNoYXRfX21pY3JvcGhvbmUtYnV0dG9uX19idXR0b25cIlxuICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgIG9uQ2xpY2s9e2NsaWNrfVxuICAgICAgPlxuICAgICAgICA8TWljcm9waG9uZUljb24gY2xhc3NOYW1lPVwid2ViY2hhdF9fbWljcm9waG9uZS1idXR0b25fX2ljb25cIiAvPlxuICAgICAgPC9JY29uQnV0dG9uPlxuICAgICAgPGRpdiBhcmlhLWxpdmU9XCJwb2xpdGVcIiBjbGFzc05hbWU9XCJzci1vbmx5XCIgaWQ9XCJ3ZWJjaGF0U2VuZEJveE1pY3JvcGhvbmVCdXR0b25cIiByb2xlPVwic3RhdHVzXCI+XG4gICAgICAgIHtsb2NhbGl6ZShkaWN0YXRpbmcgPyAnU1BFRUNIX0lOUFVUX01JQ1JPUEhPTkVfQlVUVE9OX09QRU5fQUxUJyA6ICdTUEVFQ0hfSU5QVVRfTUlDUk9QSE9ORV9CVVRUT05fQ0xPU0VfQUxUJyl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbk1pY3JvcGhvbmVCdXR0b24uZGVmYXVsdFByb3BzID0ge1xuICBjbGFzc05hbWU6ICcnXG59O1xuXG5NaWNyb3Bob25lQnV0dG9uLnByb3BUeXBlcyA9IHtcbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nXG59O1xuXG5leHBvcnQgZGVmYXVsdCBNaWNyb3Bob25lQnV0dG9uO1xuXG5leHBvcnQgeyBjb25uZWN0TWljcm9waG9uZUJ1dHRvbiwgdXNlTWljcm9waG9uZUJ1dHRvbkNsaWNrLCB1c2VNaWNyb3Bob25lQnV0dG9uRGlzYWJsZWQgfTtcbiJdfQ==