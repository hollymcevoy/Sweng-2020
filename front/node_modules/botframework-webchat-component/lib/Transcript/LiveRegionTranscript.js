"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _propTypes = _interopRequireDefault(require("prop-types"));

var _mathRandom = _interopRequireDefault(require("math-random"));

var _react = _interopRequireWildcard(require("react"));

var _LiveRegionTwinComposer = _interopRequireDefault(require("../providers/LiveRegionTwin/LiveRegionTwinComposer"));

var _ScreenReaderActivity = _interopRequireDefault(require("../ScreenReaderActivity"));

var _tabbableElements = _interopRequireDefault(require("../Utils/tabbableElements"));

var _useActivityTreeWithRenderer = _interopRequireDefault(require("../providers/ActivityTree/useActivityTreeWithRenderer"));

var _useQueueStaticElement = _interopRequireDefault(require("../providers/LiveRegionTwin/useQueueStaticElement"));

var _useStyleToEmotionObject = _interopRequireDefault(require("../hooks/internal/useStyleToEmotionObject"));

var _classnames = _interopRequireDefault(require("classnames"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useGetKeyByActivity = _botframeworkWebchatApi.hooks.useGetKeyByActivity,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var ROOT_STYLE = {
  '&.webchat__live-region-transcript': {
    '& .webchat__live-region-transcript__interactive_note': {
      color: 'transparent',
      height: 1,
      overflow: 'hidden',
      position: 'absolute',
      top: 0,
      whiteSpace: 'nowrap',
      width: 1
    }
  }
};
/**
 * Checks if the rendering activity is presentational or not. Returns `true` if presentational, otherwise, `false`.
 *
 * Presentational activity, will be rendered visually but not going through screen reader.
 */

function isPresentational(activity) {
  var _channelData$messageB, _activity$attachments;

  var channelData = activity.channelData; // "Fallback text" includes both message text and narratives for attachments.
  // Emptying out "fallback text" essentially mute for both message and attachments.

  var fallbackText = channelData === null || channelData === void 0 ? void 0 : channelData['webchat:fallback-text'];

  if (typeof fallbackText === 'string') {
    return !fallbackText;
  } // If there are "displayText" (MessageBack), "text", or any attachments, there are something to narrate.


  return !(channelData !== null && channelData !== void 0 && (_channelData$messageB = channelData.messageBack) !== null && _channelData$messageB !== void 0 && _channelData$messageB.displayText || activity.text || (_activity$attachments = activity.attachments) !== null && _activity$attachments !== void 0 && _activity$attachments.length);
}

var LiveRegionTranscriptCore = function LiveRegionTranscriptCore(_ref) {
  var activityElementMapRef = _ref.activityElementMapRef;

  var _useActivityTreeWithR = (0, _useActivityTreeWithRenderer.default)({
    flat: true
  }),
      _useActivityTreeWithR2 = _slicedToArray(_useActivityTreeWithR, 1),
      flattenedActivityTree = _useActivityTreeWithR2[0];

  var getKeyByActivity = useGetKeyByActivity();
  var localize = useLocalizer();
  var queueStaticElement = (0, _useQueueStaticElement.default)();
  var liveRegionInteractiveLabelAlt = localize('TRANSCRIPT_LIVE_REGION_INTERACTIVE_LABEL_ALT');
  var liveRegionInteractiveWithLinkLabelAlt = localize('TRANSCRIPT_LIVE_REGION_INTERACTIVE_WITH_LINKS_LABEL_ALT');
  var renderingActivities = (0, _react.useMemo)(function () {
    return Object.freeze(flattenedActivityTree.reduce(function (intermediate, _ref2) {
      var activity = _ref2.activity;
      return intermediate.set(getKeyByActivity(activity), activity);
    }, new Map()));
  }, [flattenedActivityTree, getKeyByActivity]);
  var prevRenderingActivitiesRef = (0, _react.useRef)();
  (0, _react.useEffect)(function () {
    var prevRenderingActivities = prevRenderingActivitiesRef.current;
    var appendedActivities = []; // Bottom-up, find activities which are recently appended (i.e. new activity will have a new key).
    // We only consider new activities added to the bottom of the chat history.
    // Based on how `aria-relevant="additions"` works, activities that are updated, deleted, or reordered, should be ignored.

    var _iterator = _createForOfIteratorHelper(Array.from(renderingActivities.entries()).reverse()),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var _step$value = _slicedToArray(_step.value, 2),
            key = _step$value[0],
            activity = _step$value[1];

        if (prevRenderingActivities !== null && prevRenderingActivities !== void 0 && prevRenderingActivities.has(key)) {
          break;
        }

        appendedActivities.unshift({
          activity: activity,
          key: key
        });
        isPresentational(activity) || queueStaticElement( /*#__PURE__*/_react.default.createElement(_ScreenReaderActivity.default, {
          activity: activity
        }));
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }

    var hasNewLink = appendedActivities.some(function (_ref3) {
      var _activityElementMapRe;

      var key = _ref3.key;
      return (_activityElementMapRe = activityElementMapRef.current.get(key)) === null || _activityElementMapRe === void 0 ? void 0 : _activityElementMapRe.querySelector('a');
    });
    var hasNewWidget = appendedActivities.some(function (_ref4) {
      var _activityElementMapRe2;

      var key = _ref4.key;
      return !!(0, _tabbableElements.default)((_activityElementMapRe2 = activityElementMapRef.current.get(key)) === null || _activityElementMapRe2 === void 0 ? void 0 : _activityElementMapRe2.querySelector('.webchat__basic-transcript__activity-body')).length;
    });

    if (hasNewLink || hasNewWidget) {
      // eslint-disable-next-line no-magic-numbers
      var labelId = "webchat__live-region-transcript__interactive_note--".concat((0, _mathRandom.default)().toString(36).substr(2, 5));
      queueStaticElement(
      /*#__PURE__*/
      // Inside ARIA live region:
      // - Edge + Narrator:
      //   - It read if `aria-labelledby` or `aria-label` is set;
      //   - It read nothing if `aria-labelledby` or `aria-label` are not set (in this case, it read "note").
      // - Safari + VoiceOver and Chrome + NVDA:
      //   - They read its content and ignore `aria-labelledby` or `aria-label`
      //   - They will not read if it is simply <div aria-label="Something" /> without content (self-closing tag).
      // For best compatibility, we need both `aria-labelledby` and contented <div>.
      _react.default.createElement("div", {
        "aria-atomic": "true",
        "aria-labelledby": labelId,
        className: "webchat__live-region-transcript__interactive_note",
        role: "note"
      }, /*#__PURE__*/_react.default.createElement("span", {
        id: labelId
      }, hasNewLink ? liveRegionInteractiveWithLinkLabelAlt : liveRegionInteractiveLabelAlt)));
    }

    prevRenderingActivitiesRef.current = renderingActivities;
  }, [activityElementMapRef, getKeyByActivity, liveRegionInteractiveLabelAlt, liveRegionInteractiveWithLinkLabelAlt, prevRenderingActivitiesRef, queueStaticElement, renderingActivities]);
  return null;
};

var LiveRegionTranscript = function LiveRegionTranscript(_ref5) {
  var activityElementMapRef = _ref5.activityElementMapRef;

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      internalLiveRegionFadeAfter = _useStyleOptions2[0].internalLiveRegionFadeAfter;

  var localize = useLocalizer();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var transcriptRoleDescription = localize('TRANSCRIPT_ARIA_ROLE_ALT');
  return /*#__PURE__*/_react.default.createElement(_LiveRegionTwinComposer.default, {
    "aria-roledescription": transcriptRoleDescription,
    className: (0, _classnames.default)('webchat__live-region-transcript', rootClassName),
    fadeAfter: internalLiveRegionFadeAfter,
    role: "log"
  }, /*#__PURE__*/_react.default.createElement(LiveRegionTranscriptCore, {
    activityElementMapRef: activityElementMapRef
  }));
};

LiveRegionTranscript.propTypes = {
  // PropTypes cannot be fully expressed in TypeScript.
  // @ts-ignore
  activityElementMapRef: _propTypes.default.shape({
    current: _propTypes.default.instanceOf(Map)
  }).isRequired
};
var _default = LiveRegionTranscript;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9UcmFuc2NyaXB0L0xpdmVSZWdpb25UcmFuc2NyaXB0LnRzeCJdLCJuYW1lcyI6WyJ1c2VHZXRLZXlCeUFjdGl2aXR5IiwiaG9va3MiLCJ1c2VMb2NhbGl6ZXIiLCJ1c2VTdHlsZU9wdGlvbnMiLCJST09UX1NUWUxFIiwiY29sb3IiLCJoZWlnaHQiLCJvdmVyZmxvdyIsInBvc2l0aW9uIiwidG9wIiwid2hpdGVTcGFjZSIsIndpZHRoIiwiaXNQcmVzZW50YXRpb25hbCIsImFjdGl2aXR5IiwiY2hhbm5lbERhdGEiLCJmYWxsYmFja1RleHQiLCJtZXNzYWdlQmFjayIsImRpc3BsYXlUZXh0IiwidGV4dCIsImF0dGFjaG1lbnRzIiwibGVuZ3RoIiwiTGl2ZVJlZ2lvblRyYW5zY3JpcHRDb3JlIiwiYWN0aXZpdHlFbGVtZW50TWFwUmVmIiwiZmxhdCIsImZsYXR0ZW5lZEFjdGl2aXR5VHJlZSIsImdldEtleUJ5QWN0aXZpdHkiLCJsb2NhbGl6ZSIsInF1ZXVlU3RhdGljRWxlbWVudCIsImxpdmVSZWdpb25JbnRlcmFjdGl2ZUxhYmVsQWx0IiwibGl2ZVJlZ2lvbkludGVyYWN0aXZlV2l0aExpbmtMYWJlbEFsdCIsInJlbmRlcmluZ0FjdGl2aXRpZXMiLCJPYmplY3QiLCJmcmVlemUiLCJyZWR1Y2UiLCJpbnRlcm1lZGlhdGUiLCJzZXQiLCJNYXAiLCJwcmV2UmVuZGVyaW5nQWN0aXZpdGllc1JlZiIsInByZXZSZW5kZXJpbmdBY3Rpdml0aWVzIiwiY3VycmVudCIsImFwcGVuZGVkQWN0aXZpdGllcyIsIkFycmF5IiwiZnJvbSIsImVudHJpZXMiLCJyZXZlcnNlIiwia2V5IiwiaGFzIiwidW5zaGlmdCIsImhhc05ld0xpbmsiLCJzb21lIiwiZ2V0IiwicXVlcnlTZWxlY3RvciIsImhhc05ld1dpZGdldCIsImxhYmVsSWQiLCJ0b1N0cmluZyIsInN1YnN0ciIsIkxpdmVSZWdpb25UcmFuc2NyaXB0IiwiaW50ZXJuYWxMaXZlUmVnaW9uRmFkZUFmdGVyIiwicm9vdENsYXNzTmFtZSIsInRyYW5zY3JpcHRSb2xlRGVzY3JpcHRpb24iLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJzaGFwZSIsImluc3RhbmNlT2YiLCJpc1JlcXVpcmVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFLQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLElBQVFBLG1CQUFSLEdBQStEQyw2QkFBL0QsQ0FBUUQsbUJBQVI7QUFBQSxJQUE2QkUsWUFBN0IsR0FBK0RELDZCQUEvRCxDQUE2QkMsWUFBN0I7QUFBQSxJQUEyQ0MsZUFBM0MsR0FBK0RGLDZCQUEvRCxDQUEyQ0UsZUFBM0M7QUFFQSxJQUFNQyxVQUFVLEdBQUc7QUFDakIsdUNBQXFDO0FBQ25DLDREQUF3RDtBQUN0REMsTUFBQUEsS0FBSyxFQUFFLGFBRCtDO0FBRXREQyxNQUFBQSxNQUFNLEVBQUUsQ0FGOEM7QUFHdERDLE1BQUFBLFFBQVEsRUFBRSxRQUg0QztBQUl0REMsTUFBQUEsUUFBUSxFQUFFLFVBSjRDO0FBS3REQyxNQUFBQSxHQUFHLEVBQUUsQ0FMaUQ7QUFNdERDLE1BQUFBLFVBQVUsRUFBRSxRQU4wQztBQU90REMsTUFBQUEsS0FBSyxFQUFFO0FBUCtDO0FBRHJCO0FBRHBCLENBQW5CO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQSxTQUFTQyxnQkFBVCxDQUEwQkMsUUFBMUIsRUFBaUU7QUFBQTs7QUFDL0QsTUFBUUMsV0FBUixHQUNFRCxRQURGLENBQVFDLFdBQVIsQ0FEK0QsQ0FJL0Q7QUFDQTs7QUFDQSxNQUFNQyxZQUFZLEdBQUdELFdBQUgsYUFBR0EsV0FBSCx1QkFBR0EsV0FBVyxDQUFHLHVCQUFILENBQWhDOztBQUVBLE1BQUksT0FBT0MsWUFBUCxLQUF3QixRQUE1QixFQUFzQztBQUNwQyxXQUFPLENBQUNBLFlBQVI7QUFDRCxHQVY4RCxDQVkvRDs7O0FBQ0EsU0FBTyxF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LHNCQUNFLDZCQUFDLCtCQUFEO0FBQ0UsNEJBQXNCaUMseUJBRHhCO0FBRUUsSUFBQSxTQUFTLEVBQUUseUJBQVcsaUNBQVgsRUFBOENELGFBQTlDLENBRmI7QUFHRSxJQUFBLFNBQVMsRUFBRUQsMkJBSGI7QUFJRSxJQUFBLElBQUksRUFBQztBQUpQLGtCQU1FLDZCQUFDLHdCQUFEO0FBQTBCLElBQUEscUJBQXFCLEVBQUVuQztBQUFqRCxJQU5GLENBREY7QUFVRCxDQWpCRDs7QUFtQkFrQyxvQkFBb0IsQ0FBQ0ksU0FBckIsR0FBaUM7QUFDL0I7QUFDQTtBQUNBdEMsRUFBQUEscUJBQXFCLEVBQUV1QyxtQkFBVUMsS0FBVixDQUFnQjtBQUNyQ3ZCLElBQUFBLE9BQU8sRUFBRXNCLG1CQUFVRSxVQUFWLENBQXFCM0IsR0FBckI7QUFENEIsR0FBaEIsRUFFcEI0QjtBQUw0QixDQUFqQztlQVFlUixvQiIsInNvdXJjZVJvb3QiOiJjb21wb25lbnQ6Ly8vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaG9va3MgfSBmcm9tICdib3RmcmFtZXdvcmstd2ViY2hhdC1hcGknO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCByYW5kb20gZnJvbSAnbWF0aC1yYW5kb20nO1xuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgdHlwZSB7IERpcmVjdExpbmVBY3Rpdml0eSB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWNvcmUnO1xuaW1wb3J0IHR5cGUgeyBGQywgUmVmT2JqZWN0LCBWRkMgfSBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBMaXZlUmVnaW9uVHdpbkNvbXBvc2VyIGZyb20gJy4uL3Byb3ZpZGVycy9MaXZlUmVnaW9uVHdpbi9MaXZlUmVnaW9uVHdpbkNvbXBvc2VyJztcbmltcG9ydCBTY3JlZW5SZWFkZXJBY3Rpdml0eSBmcm9tICcuLi9TY3JlZW5SZWFkZXJBY3Rpdml0eSc7XG5pbXBvcnQgdGFiYmFibGVFbGVtZW50cyBmcm9tICcuLi9VdGlscy90YWJiYWJsZUVsZW1lbnRzJztcbmltcG9ydCB1c2VBY3Rpdml0eVRyZWVXaXRoUmVuZGVyZXIgZnJvbSAnLi4vcHJvdmlkZXJzL0FjdGl2aXR5VHJlZS91c2VBY3Rpdml0eVRyZWVXaXRoUmVuZGVyZXInO1xuaW1wb3J0IHVzZVF1ZXVlU3RhdGljRWxlbWVudCBmcm9tICcuLi9wcm92aWRlcnMvTGl2ZVJlZ2lvblR3aW4vdXNlUXVldWVTdGF0aWNFbGVtZW50JztcbmltcG9ydCB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCBmcm9tICcuLi9ob29rcy9pbnRlcm5hbC91c2VTdHlsZVRvRW1vdGlvbk9iamVjdCc7XG5cbmltcG9ydCB0eXBlIHsgQWN0aXZpdHlFbGVtZW50TWFwIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuY29uc3QgeyB1c2VHZXRLZXlCeUFjdGl2aXR5LCB1c2VMb2NhbGl6ZXIsIHVzZVN0eWxlT3B0aW9ucyB9ID0gaG9va3M7XG5cbmNvbnN0IFJPT1RfU1RZTEUgPSB7XG4gICcmLndlYmNoYXRfX2xpdmUtcmVnaW9uLXRyYW5zY3JpcHQnOiB7XG4gICAgJyYgLndlYmNoYXRfX2xpdmUtcmVnaW9uLXRyYW5zY3JpcHRfX2ludGVyYWN0aXZlX25vdGUnOiB7XG4gICAgICBjb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICAgIGhlaWdodDogMSxcbiAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgdG9wOiAwLFxuICAgICAgd2hpdGVTcGFjZTogJ25vd3JhcCcsXG4gICAgICB3aWR0aDogMVxuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIHJlbmRlcmluZyBhY3Rpdml0eSBpcyBwcmVzZW50YXRpb25hbCBvciBub3QuIFJldHVybnMgYHRydWVgIGlmIHByZXNlbnRhdGlvbmFsLCBvdGhlcndpc2UsIGBmYWxzZWAuXG4gKlxuICogUHJlc2VudGF0aW9uYWwgYWN0aXZpdHksIHdpbGwgYmUgcmVuZGVyZWQgdmlzdWFsbHkgYnV0IG5vdCBnb2luZyB0aHJvdWdoIHNjcmVlbiByZWFkZXIuXG4gKi9cbmZ1bmN0aW9uIGlzUHJlc2VudGF0aW9uYWwoYWN0aXZpdHk6IERpcmVjdExpbmVBY3Rpdml0eSk6IGJvb2xlYW4ge1xuICBjb25zdCB7IGNoYW5uZWxEYXRhIH06IHsgYXR0YWNobWVudHM/OiBbXTsgY2hhbm5lbERhdGE/OiB7IG1lc3NhZ2VCYWNrPzogeyBkaXNwbGF5VGV4dD86IHN0cmluZyB9IH07IHRleHQ/OiBzdHJpbmcgfSA9XG4gICAgYWN0aXZpdHk7XG5cbiAgLy8gXCJGYWxsYmFjayB0ZXh0XCIgaW5jbHVkZXMgYm90aCBtZXNzYWdlIHRleHQgYW5kIG5hcnJhdGl2ZXMgZm9yIGF0dGFjaG1lbnRzLlxuICAvLyBFbXB0eWluZyBvdXQgXCJmYWxsYmFjayB0ZXh0XCIgZXNzZW50aWFsbHkgbXV0ZSBmb3IgYm90aCBtZXNzYWdlIGFuZCBhdHRhY2htZW50cy5cbiAgY29uc3QgZmFsbGJhY2tUZXh0ID0gY2hhbm5lbERhdGE/Llsnd2ViY2hhdDpmYWxsYmFjay10ZXh0J107XG5cbiAgaWYgKHR5cGVvZiBmYWxsYmFja1RleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuICFmYWxsYmFja1RleHQ7XG4gIH1cblxuICAvLyBJZiB0aGVyZSBhcmUgXCJkaXNwbGF5VGV4dFwiIChNZXNzYWdlQmFjayksIFwidGV4dFwiLCBvciBhbnkgYXR0YWNobWVudHMsIHRoZXJlIGFyZSBzb21ldGhpbmcgdG8gbmFycmF0ZS5cbiAgcmV0dXJuICEoY2hhbm5lbERhdGE/Lm1lc3NhZ2VCYWNrPy5kaXNwbGF5VGV4dCB8fCBhY3Rpdml0eS50ZXh0IHx8IGFjdGl2aXR5LmF0dGFjaG1lbnRzPy5sZW5ndGgpO1xufVxuXG50eXBlIFJlbmRlcmluZ0FjdGl2aXRpZXMgPSBNYXA8c3RyaW5nLCBEaXJlY3RMaW5lQWN0aXZpdHk+O1xuXG50eXBlIExpdmVSZWdpb25UcmFuc2NyaXB0Q29yZVByb3BzID0ge1xuICBhY3Rpdml0eUVsZW1lbnRNYXBSZWY6IFJlZk9iamVjdDxBY3Rpdml0eUVsZW1lbnRNYXA+O1xufTtcblxuY29uc3QgTGl2ZVJlZ2lvblRyYW5zY3JpcHRDb3JlOiBGQzxMaXZlUmVnaW9uVHJhbnNjcmlwdENvcmVQcm9wcz4gPSAoeyBhY3Rpdml0eUVsZW1lbnRNYXBSZWYgfSkgPT4ge1xuICBjb25zdCBbZmxhdHRlbmVkQWN0aXZpdHlUcmVlXSA9IHVzZUFjdGl2aXR5VHJlZVdpdGhSZW5kZXJlcih7IGZsYXQ6IHRydWUgfSk7XG4gIGNvbnN0IGdldEtleUJ5QWN0aXZpdHkgPSB1c2VHZXRLZXlCeUFjdGl2aXR5KCk7XG4gIGNvbnN0IGxvY2FsaXplID0gdXNlTG9jYWxpemVyKCk7XG4gIGNvbnN0IHF1ZXVlU3RhdGljRWxlbWVudCA9IHVzZVF1ZXVlU3RhdGljRWxlbWVudCgpO1xuXG4gIGNvbnN0IGxpdmVSZWdpb25JbnRlcmFjdGl2ZUxhYmVsQWx0ID0gbG9jYWxpemUoJ1RSQU5TQ1JJUFRfTElWRV9SRUdJT05fSU5URVJBQ1RJVkVfTEFCRUxfQUxUJyk7XG4gIGNvbnN0IGxpdmVSZWdpb25JbnRlcmFjdGl2ZVdpdGhMaW5rTGFiZWxBbHQgPSBsb2NhbGl6ZSgnVFJBTlNDUklQVF9MSVZFX1JFR0lPTl9JTlRFUkFDVElWRV9XSVRIX0xJTktTX0xBQkVMX0FMVCcpO1xuXG4gIGNvbnN0IHJlbmRlcmluZ0FjdGl2aXRpZXMgPSB1c2VNZW1vPFJlYWRvbmx5PFJlbmRlcmluZ0FjdGl2aXRpZXM+PihcbiAgICAoKSA9PlxuICAgICAgT2JqZWN0LmZyZWV6ZShcbiAgICAgICAgZmxhdHRlbmVkQWN0aXZpdHlUcmVlLnJlZHVjZTxSZW5kZXJpbmdBY3Rpdml0aWVzPihcbiAgICAgICAgICAoaW50ZXJtZWRpYXRlLCB7IGFjdGl2aXR5IH0pID0+IGludGVybWVkaWF0ZS5zZXQoZ2V0S2V5QnlBY3Rpdml0eShhY3Rpdml0eSksIGFjdGl2aXR5KSxcbiAgICAgICAgICBuZXcgTWFwPHN0cmluZywgRGlyZWN0TGluZUFjdGl2aXR5PigpXG4gICAgICAgIClcbiAgICAgICksXG4gICAgW2ZsYXR0ZW5lZEFjdGl2aXR5VHJlZSwgZ2V0S2V5QnlBY3Rpdml0eV1cbiAgKTtcblxuICBjb25zdCBwcmV2UmVuZGVyaW5nQWN0aXZpdGllc1JlZiA9IHVzZVJlZjxSZWFkb25seTxSZW5kZXJpbmdBY3Rpdml0aWVzPj4oKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHsgY3VycmVudDogcHJldlJlbmRlcmluZ0FjdGl2aXRpZXMgfSA9IHByZXZSZW5kZXJpbmdBY3Rpdml0aWVzUmVmO1xuICAgIGNvbnN0IGFwcGVuZGVkQWN0aXZpdGllczogeyBhY3Rpdml0eTogRGlyZWN0TGluZUFjdGl2aXR5OyBrZXk6IHN0cmluZyB9W10gPSBbXTtcblxuICAgIC8vIEJvdHRvbS11cCwgZmluZCBhY3Rpdml0aWVzIHdoaWNoIGFyZSByZWNlbnRseSBhcHBlbmRlZCAoaS5lLiBuZXcgYWN0aXZpdHkgd2lsbCBoYXZlIGEgbmV3IGtleSkuXG4gICAgLy8gV2Ugb25seSBjb25zaWRlciBuZXcgYWN0aXZpdGllcyBhZGRlZCB0byB0aGUgYm90dG9tIG9mIHRoZSBjaGF0IGhpc3RvcnkuXG4gICAgLy8gQmFzZWQgb24gaG93IGBhcmlhLXJlbGV2YW50PVwiYWRkaXRpb25zXCJgIHdvcmtzLCBhY3Rpdml0aWVzIHRoYXQgYXJlIHVwZGF0ZWQsIGRlbGV0ZWQsIG9yIHJlb3JkZXJlZCwgc2hvdWxkIGJlIGlnbm9yZWQuXG4gICAgZm9yIChjb25zdCBba2V5LCBhY3Rpdml0eV0gb2YgQXJyYXkuZnJvbShyZW5kZXJpbmdBY3Rpdml0aWVzLmVudHJpZXMoKSkucmV2ZXJzZSgpKSB7XG4gICAgICBpZiAocHJldlJlbmRlcmluZ0FjdGl2aXRpZXM/LmhhcyhrZXkpKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBhcHBlbmRlZEFjdGl2aXRpZXMudW5zaGlmdCh7IGFjdGl2aXR5LCBrZXkgfSk7XG5cbiAgICAgIGlzUHJlc2VudGF0aW9uYWwoYWN0aXZpdHkpIHx8IHF1ZXVlU3RhdGljRWxlbWVudCg8U2NyZWVuUmVhZGVyQWN0aXZpdHkgYWN0aXZpdHk9e2FjdGl2aXR5fSAvPik7XG4gICAgfVxuXG4gICAgY29uc3QgaGFzTmV3TGluayA9IGFwcGVuZGVkQWN0aXZpdGllcy5zb21lKCh7IGtleSB9KSA9PiBhY3Rpdml0eUVsZW1lbnRNYXBSZWYuY3VycmVudC5nZXQoa2V5KT8ucXVlcnlTZWxlY3RvcignYScpKTtcblxuICAgIGNvbnN0IGhhc05ld1dpZGdldCA9IGFwcGVuZGVkQWN0aXZpdGllcy5zb21lKFxuICAgICAgKHsga2V5IH0pID0+XG4gICAgICAgICEhdGFiYmFibGVFbGVtZW50cyhcbiAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRNYXBSZWYuY3VycmVudC5nZXQoa2V5KT8ucXVlcnlTZWxlY3RvcignLndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LWJvZHknKVxuICAgICAgICApLmxlbmd0aFxuICAgICk7XG5cbiAgICBpZiAoaGFzTmV3TGluayB8fCBoYXNOZXdXaWRnZXQpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1tYWdpYy1udW1iZXJzXG4gICAgICBjb25zdCBsYWJlbElkID0gYHdlYmNoYXRfX2xpdmUtcmVnaW9uLXRyYW5zY3JpcHRfX2ludGVyYWN0aXZlX25vdGUtLSR7cmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA1KX1gO1xuXG4gICAgICBxdWV1ZVN0YXRpY0VsZW1lbnQoXG4gICAgICAgIC8vIEluc2lkZSBBUklBIGxpdmUgcmVnaW9uOlxuICAgICAgICAvLyAtIEVkZ2UgKyBOYXJyYXRvcjpcbiAgICAgICAgLy8gICAtIEl0IHJlYWQgaWYgYGFyaWEtbGFiZWxsZWRieWAgb3IgYGFyaWEtbGFiZWxgIGlzIHNldDtcbiAgICAgICAgLy8gICAtIEl0IHJlYWQgbm90aGluZyBpZiBgYXJpYS1sYWJlbGxlZGJ5YCBvciBgYXJpYS1sYWJlbGAgYXJlIG5vdCBzZXQgKGluIHRoaXMgY2FzZSwgaXQgcmVhZCBcIm5vdGVcIikuXG4gICAgICAgIC8vIC0gU2FmYXJpICsgVm9pY2VPdmVyIGFuZCBDaHJvbWUgKyBOVkRBOlxuICAgICAgICAvLyAgIC0gVGhleSByZWFkIGl0cyBjb250ZW50IGFuZCBpZ25vcmUgYGFyaWEtbGFiZWxsZWRieWAgb3IgYGFyaWEtbGFiZWxgXG4gICAgICAgIC8vICAgLSBUaGV5IHdpbGwgbm90IHJlYWQgaWYgaXQgaXMgc2ltcGx5IDxkaXYgYXJpYS1sYWJlbD1cIlNvbWV0aGluZ1wiIC8+IHdpdGhvdXQgY29udGVudCAoc2VsZi1jbG9zaW5nIHRhZykuXG4gICAgICAgIC8vIEZvciBiZXN0IGNvbXBhdGliaWxpdHksIHdlIG5lZWQgYm90aCBgYXJpYS1sYWJlbGxlZGJ5YCBhbmQgY29udGVudGVkIDxkaXY+LlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgYXJpYS1hdG9taWM9XCJ0cnVlXCJcbiAgICAgICAgICBhcmlhLWxhYmVsbGVkYnk9e2xhYmVsSWR9XG4gICAgICAgICAgY2xhc3NOYW1lPVwid2ViY2hhdF9fbGl2ZS1yZWdpb24tdHJhbnNjcmlwdF9faW50ZXJhY3RpdmVfbm90ZVwiXG4gICAgICAgICAgcm9sZT1cIm5vdGVcIlxuICAgICAgICA+XG4gICAgICAgICAgey8qIFwiaWRcIiBpcyByZXF1aXJlZCBmb3IgXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIiAqL31cbiAgICAgICAgICB7LyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2ZvcmJpZC1kb20tcHJvcHMgKi99XG4gICAgICAgICAgPHNwYW4gaWQ9e2xhYmVsSWR9PntoYXNOZXdMaW5rID8gbGl2ZVJlZ2lvbkludGVyYWN0aXZlV2l0aExpbmtMYWJlbEFsdCA6IGxpdmVSZWdpb25JbnRlcmFjdGl2ZUxhYmVsQWx0fTwvc3Bhbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIHByZXZSZW5kZXJpbmdBY3Rpdml0aWVzUmVmLmN1cnJlbnQgPSByZW5kZXJpbmdBY3Rpdml0aWVzO1xuICB9LCBbXG4gICAgYWN0aXZpdHlFbGVtZW50TWFwUmVmLFxuICAgIGdldEtleUJ5QWN0aXZpdHksXG4gICAgbGl2ZVJlZ2lvbkludGVyYWN0aXZlTGFiZWxBbHQsXG4gICAgbGl2ZVJlZ2lvbkludGVyYWN0aXZlV2l0aExpbmtMYWJlbEFsdCxcbiAgICBwcmV2UmVuZGVyaW5nQWN0aXZpdGllc1JlZixcbiAgICBxdWV1ZVN0YXRpY0VsZW1lbnQsXG4gICAgcmVuZGVyaW5nQWN0aXZpdGllc1xuICBdKTtcblxuICByZXR1cm4gbnVsbDtcbn07XG5cbnR5cGUgTGl2ZVJlZ2lvblRyYW5zY3JpcHRQcm9wcyA9IHtcbiAgYWN0aXZpdHlFbGVtZW50TWFwUmVmOiBSZWZPYmplY3Q8QWN0aXZpdHlFbGVtZW50TWFwPjtcbn07XG5cbmNvbnN0IExpdmVSZWdpb25UcmFuc2NyaXB0OiBWRkM8TGl2ZVJlZ2lvblRyYW5zY3JpcHRQcm9wcz4gPSAoeyBhY3Rpdml0eUVsZW1lbnRNYXBSZWYgfSkgPT4ge1xuICBjb25zdCBbeyBpbnRlcm5hbExpdmVSZWdpb25GYWRlQWZ0ZXIgfV0gPSB1c2VTdHlsZU9wdGlvbnMoKTtcbiAgY29uc3QgbG9jYWxpemUgPSB1c2VMb2NhbGl6ZXIoKTtcbiAgY29uc3Qgcm9vdENsYXNzTmFtZSA9IHVzZVN0eWxlVG9FbW90aW9uT2JqZWN0KCkoUk9PVF9TVFlMRSkgKyAnJztcblxuICBjb25zdCB0cmFuc2NyaXB0Um9sZURlc2NyaXB0aW9uID0gbG9jYWxpemUoJ1RSQU5TQ1JJUFRfQVJJQV9ST0xFX0FMVCcpO1xuXG4gIHJldHVybiAoXG4gICAgPExpdmVSZWdpb25Ud2luQ29tcG9zZXJcbiAgICAgIGFyaWEtcm9sZWRlc2NyaXB0aW9uPXt0cmFuc2NyaXB0Um9sZURlc2NyaXB0aW9ufVxuICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKCd3ZWJjaGF0X19saXZlLXJlZ2lvbi10cmFuc2NyaXB0Jywgcm9vdENsYXNzTmFtZSl9XG4gICAgICBmYWRlQWZ0ZXI9e2ludGVybmFsTGl2ZVJlZ2lvbkZhZGVBZnRlcn1cbiAgICAgIHJvbGU9XCJsb2dcIlxuICAgID5cbiAgICAgIDxMaXZlUmVnaW9uVHJhbnNjcmlwdENvcmUgYWN0aXZpdHlFbGVtZW50TWFwUmVmPXthY3Rpdml0eUVsZW1lbnRNYXBSZWZ9IC8+XG4gICAgPC9MaXZlUmVnaW9uVHdpbkNvbXBvc2VyPlxuICApO1xufTtcblxuTGl2ZVJlZ2lvblRyYW5zY3JpcHQucHJvcFR5cGVzID0ge1xuICAvLyBQcm9wVHlwZXMgY2Fubm90IGJlIGZ1bGx5IGV4cHJlc3NlZCBpbiBUeXBlU2NyaXB0LlxuICAvLyBAdHMtaWdub3JlXG4gIGFjdGl2aXR5RWxlbWVudE1hcFJlZjogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICBjdXJyZW50OiBQcm9wVHlwZXMuaW5zdGFuY2VPZihNYXApXG4gIH0pLmlzUmVxdWlyZWRcbn07XG5cbmV4cG9ydCBkZWZhdWx0IExpdmVSZWdpb25UcmFuc2NyaXB0O1xuIl19