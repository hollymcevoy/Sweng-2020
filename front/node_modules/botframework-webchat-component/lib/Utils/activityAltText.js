"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = activityAltText;

var _textFormatToContentType = _interopRequireDefault(require("./textFormatToContentType"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function walk(document, walker) {
  var nodes = [].slice.call(document.childNodes);
  var results = [];

  while (nodes.length) {
    var _node = nodes.shift();

    var childNodes = _node.childNodes;
    results.push.apply(results, _toConsumableArray(walker(_node) || []));
    nodes.unshift.apply(nodes, _toConsumableArray([].slice.call(childNodes)));
  }

  return results;
} // From https://developer.mozilla.org/en-US/docs/Web/HTML/Inline_elements


var HTML_INLINE_TAGS = ['A', 'ABBR', 'ACRONYM', 'AUDIO', 'B', 'BDI', 'BDO', 'BIG', 'BR', 'BUTTON', 'CANVAS', 'CITE', 'CODE', 'DATA', 'DATALIST', 'DEL', 'DFN', 'EM', 'EMBED', 'I', 'IFRAME', 'IMG', 'INPUT', 'INS', 'KBD', 'LABEL', 'MAP', 'MARK', 'METER', 'NOSCRIPT', 'OBJECT', 'OUTPUT', 'PICTURE', 'PROGRESS', 'Q', 'RUBY', 'S', 'SAMP', 'SCRIPT', 'SELECT', 'SLOT', 'SMALL', 'SPAN', 'STRONG', 'SUB', 'SUP', 'SVG', 'TEMPLATE', 'TEXTAREA', 'TIME', 'U', 'TT', 'VAR', 'VIDEO', 'WBR'];
/**
 * Computes all text from a given HTML document as flattened array. This is best-effort.
 *
 * @param {Document} document - HTML document to computes texts from.
 */

function htmlTextAlternatives(document) {
  // TODO: [P2] #3923 Revisit this logic with W3C standard, we could do a better text alternatives computation.
  //       For example, <abbr title="..."> is not computed.
  //       https://www.w3.org/TR/accname-1.1/#mapping_additional_nd_name
  return walk(document, function (node) {
    var nodeType = node.nodeType,
        tagName = node.tagName,
        textContent = node.textContent;

    if (nodeType === Node.TEXT_NODE) {
      return [textContent];
    } else if (tagName === 'IMG') {
      return [node.getAttribute('alt')];
    } else if (!HTML_INLINE_TAGS.includes(tagName)) {
      return ['\n'];
    }
  });
}
/**
 * Returns the text alternatives for a message activity.
 *
 * @param {object} activity - Activity to compute the text alternatives.
 * @param {function} renderMarkdownAsHTML - Callback function to render Markdown as HTML string.
 */


function activityAltText(activity, renderMarkdownAsHTML) {
  var _activity$channelData, _activity$channelData2, _activity$channelData3;

  if (activity.type !== 'message') {
    return false;
  }

  var fallbackText = activity === null || activity === void 0 ? void 0 : (_activity$channelData = activity.channelData) === null || _activity$channelData === void 0 ? void 0 : _activity$channelData['webchat:fallback-text'];

  if (typeof fallbackText === 'string') {
    // If `fallbackText` is an empty string, we will treat the activity as presentational and skip narrating it (return false).
    return fallbackText || false;
  }

  var text = (activity === null || activity === void 0 ? void 0 : (_activity$channelData2 = activity.channelData) === null || _activity$channelData2 === void 0 ? void 0 : (_activity$channelData3 = _activity$channelData2.messageBack) === null || _activity$channelData3 === void 0 ? void 0 : _activity$channelData3.displayText) || activity.text;

  if (!text) {
    // We will continue to narrate the activity, as empty.
    return '';
  }

  if (renderMarkdownAsHTML && (0, _textFormatToContentType.default)(activity.textFormat) === 'text/markdown') {
    return htmlTextAlternatives(new DOMParser().parseFromString(renderMarkdownAsHTML(text), 'text/html')).join('').replace(/\n{2,}/g, '\n').trim();
  }

  return text;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9VdGlscy9hY3Rpdml0eUFsdFRleHQudHMiXSwibmFtZXMiOlsid2FsayIsImRvY3VtZW50Iiwid2Fsa2VyIiwibm9kZXMiLCJzbGljZSIsImNhbGwiLCJjaGlsZE5vZGVzIiwicmVzdWx0cyIsImxlbmd0aCIsIm5vZGUiLCJzaGlmdCIsInB1c2giLCJ1bnNoaWZ0IiwiSFRNTF9JTkxJTkVfVEFHUyIsImh0bWxUZXh0QWx0ZXJuYXRpdmVzIiwibm9kZVR5cGUiLCJ0YWdOYW1lIiwidGV4dENvbnRlbnQiLCJOb2RlIiwiVEVYVF9OT0RFIiwiZ2V0QXR0cmlidXRlIiwiaW5jbHVkZXMiLCJhY3Rpdml0eUFsdFRleHQiLCJhY3Rpdml0eSIsInJlbmRlck1hcmtkb3duQXNIVE1MIiwidHlwZSIsImZhbGxiYWNrVGV4dCIsImNoYW5uZWxEYXRhIiwidGV4dCIsIm1lc3NhZ2VCYWNrIiwiZGlzcGxheVRleHQiLCJ0ZXh0Rm9ybWF0IiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwiam9pbiIsInJlcGxhY2UiLCJ0cmltIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxTQUFTQSxJQUFULENBQThCQyxRQUE5QixFQUFrREMsTUFBbEQsRUFBMkY7QUFDekYsTUFBTUMsS0FBVSxHQUFHLEdBQUdDLEtBQUgsQ0FBU0MsSUFBVCxDQUFjSixRQUFRLENBQUNLLFVBQXZCLENBQW5CO0FBQ0EsTUFBTUMsT0FBaUIsR0FBRyxFQUExQjs7QUFFQSxTQUFPSixLQUFLLENBQUNLLE1BQWIsRUFBcUI7QUFDbkIsUUFBTUMsS0FBSSxHQUFHTixLQUFLLENBQUNPLEtBQU4sRUFBYjs7QUFDQSxRQUFRSixVQUFSLEdBQXVCRyxLQUF2QixDQUFRSCxVQUFSO0FBRUFDLElBQUFBLE9BQU8sQ0FBQ0ksSUFBUixPQUFBSixPQUFPLHFCQUFVTCxNQUFNLENBQUNPLEtBQUQsQ0FBTixJQUFnQixFQUExQixFQUFQO0FBQ0FOLElBQUFB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Q0FBQUEsUUFBUSxDQUFFSSxXQUFWLDRHQUF1QkUsV0FBdkIsa0ZBQW9DQyxXQUFwQyxLQUFtRFAsUUFBUSxDQUFDSyxJQUF6RTs7QUFFQSxNQUFJLENBQUNBLElBQUwsRUFBVztBQUNUO0FBQ0EsV0FBTyxFQUFQO0FBQ0Q7O0FBRUQsTUFBSUosb0JBQW9CLElBQUksc0NBQXdCRCxRQUFRLENBQUNRLFVBQWpDLE1BQWlELGVBQTdFLEVBQThGO0FBQzVGLFdBQU9qQixvQkFBb0IsQ0FBQyxJQUFJa0IsU0FBSixHQUFnQkMsZUFBaEIsQ0FBZ0NULG9CQUFvQixDQUFDSSxJQUFELENBQXBELEVBQTRELFdBQTVELENBQUQsQ0FBcEIsQ0FDSk0sSUFESSxDQUNDLEVBREQsRUFFSkMsT0FGSSxDQUVJLFNBRkosRUFFZ0IsSUFGaEIsRUFHSkMsSUFISSxFQUFQO0FBSUQ7O0FBRUQsU0FBT1IsSUFBUDtBQUNEIiwic291cmNlUm9vdCI6ImNvbXBvbmVudDovLy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdGV4dEZvcm1hdFRvQ29udGVudFR5cGUgZnJvbSAnLi90ZXh0Rm9ybWF0VG9Db250ZW50VHlwZSc7XG5cbmZ1bmN0aW9uIHdhbGs8VCBleHRlbmRzIE5vZGU+KGRvY3VtZW50OiBEb2N1bWVudCwgd2Fsa2VyOiAobm9kZTogVCkgPT4gc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gIGNvbnN0IG5vZGVzOiBUW10gPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LmNoaWxkTm9kZXMpO1xuICBjb25zdCByZXN1bHRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIHdoaWxlIChub2Rlcy5sZW5ndGgpIHtcbiAgICBjb25zdCBub2RlID0gbm9kZXMuc2hpZnQoKTtcbiAgICBjb25zdCB7IGNoaWxkTm9kZXMgfSA9IG5vZGU7XG5cbiAgICByZXN1bHRzLnB1c2goLi4uKHdhbGtlcihub2RlKSB8fCBbXSkpO1xuICAgIG5vZGVzLnVuc2hpZnQoLi4uW10uc2xpY2UuY2FsbChjaGlsZE5vZGVzKSk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0cztcbn1cblxuLy8gRnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0lubGluZV9lbGVtZW50c1xuY29uc3QgSFRNTF9JTkxJTkVfVEFHUyA9IFtcbiAgJ0EnLFxuICAnQUJCUicsXG4gICdBQ1JPTllNJyxcbiAgJ0FVRElPJyxcbiAgJ0InLFxuICAnQkRJJyxcbiAgJ0JETycsXG4gICdCSUcnLFxuICAnQlInLFxuICAnQlVUVE9OJyxcbiAgJ0NBTlZBUycsXG4gICdDSVRFJyxcbiAgJ0NPREUnLFxuICAnREFUQScsXG4gICdEQVRBTElTVCcsXG4gICdERUwnLFxuICAnREZOJyxcbiAgJ0VNJyxcbiAgJ0VNQkVEJyxcbiAgJ0knLFxuICAnSUZSQU1FJyxcbiAgJ0lNRycsXG4gICdJTlBVVCcsXG4gICdJTlMnLFxuICAnS0JEJyxcbiAgJ0xBQkVMJyxcbiAgJ01BUCcsXG4gICdNQVJLJyxcbiAgJ01FVEVSJyxcbiAgJ05PU0NSSVBUJyxcbiAgJ09CSkVDVCcsXG4gICdPVVRQVVQnLFxuICAnUElDVFVSRScsXG4gICdQUk9HUkVTUycsXG4gICdRJyxcbiAgJ1JVQlknLFxuICAnUycsXG4gICdTQU1QJyxcbiAgJ1NDUklQVCcsXG4gICdTRUxFQ1QnLFxuICAnU0xPVCcsXG4gICdTTUFMTCcsXG4gICdTUEFOJyxcbiAgJ1NUUk9ORycsXG4gICdTVUInLFxuICAnU1VQJyxcbiAgJ1NWRycsXG4gICdURU1QTEFURScsXG4gICdURVhUQVJFQScsXG4gICdUSU1FJyxcbiAgJ1UnLFxuICAnVFQnLFxuICAnVkFSJyxcbiAgJ1ZJREVPJyxcbiAgJ1dCUidcbl07XG5cbi8qKlxuICogQ29tcHV0ZXMgYWxsIHRleHQgZnJvbSBhIGdpdmVuIEhUTUwgZG9jdW1lbnQgYXMgZmxhdHRlbmVkIGFycmF5LiBUaGlzIGlzIGJlc3QtZWZmb3J0LlxuICpcbiAqIEBwYXJhbSB7RG9jdW1lbnR9IGRvY3VtZW50IC0gSFRNTCBkb2N1bWVudCB0byBjb21wdXRlcyB0ZXh0cyBmcm9tLlxuICovXG5mdW5jdGlvbiBodG1sVGV4dEFsdGVybmF0aXZlcyhkb2N1bWVudDogRG9jdW1lbnQpOiBzdHJpbmdbXSB7XG4gIC8vIFRPRE86IFtQMl0gIzM5MjMgUmV2aXNpdCB0aGlzIGxvZ2ljIHdpdGggVzNDIHN0YW5kYXJkLCB3ZSBjb3VsZCBkbyBhIGJldHRlciB0ZXh0IGFsdGVybmF0aXZlcyBjb21wdXRhdGlvbi5cbiAgLy8gICAgICAgRm9yIGV4YW1wbGUsIDxhYmJyIHRpdGxlPVwiLi4uXCI+IGlzIG5vdCBjb21wdXRlZC5cbiAgLy8gICAgICAgaHR0cHM6Ly93d3cudzMub3JnL1RSL2FjY25hbWUtMS4xLyNtYXBwaW5nX2FkZGl0aW9uYWxfbmRfbmFtZVxuICByZXR1cm4gd2FsazxIVE1MRWxlbWVudD4oZG9jdW1lbnQsIG5vZGUgPT4ge1xuICAgIGNvbnN0IHsgbm9kZVR5cGUsIHRhZ05hbWUsIHRleHRDb250ZW50IH0gPSBub2RlO1xuXG4gICAgaWYgKG5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgcmV0dXJuIFt0ZXh0Q29udGVudF07XG4gICAgfSBlbHNlIGlmICh0YWdOYW1lID09PSAnSU1HJykge1xuICAgICAgcmV0dXJuIFtub2RlLmdldEF0dHJpYnV0ZSgnYWx0JyldO1xuICAgIH0gZWxzZSBpZiAoIUhUTUxfSU5MSU5FX1RBR1MuaW5jbHVkZXModGFnTmFtZSkpIHtcbiAgICAgIHJldHVybiBbJ1xcbiddO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgdGV4dCBhbHRlcm5hdGl2ZXMgZm9yIGEgbWVzc2FnZSBhY3Rpdml0eS5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aXZpdHkgLSBBY3Rpdml0eSB0byBjb21wdXRlIHRoZSB0ZXh0IGFsdGVybmF0aXZlcy5cbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlbmRlck1hcmtkb3duQXNIVE1MIC0gQ2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVuZGVyIE1hcmtkb3duIGFzIEhUTUwgc3RyaW5nLlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhY3Rpdml0eUFsdFRleHQoXG4gIGFjdGl2aXR5OiBhbnksXG4gIHJlbmRlck1hcmtkb3duQXNIVE1MPzogKG1hcmtkb3duOiBzdHJpbmcpID0+IHN0cmluZ1xuKTogZmFsc2UgfCBzdHJpbmcge1xuICBpZiAoYWN0aXZpdHkudHlwZSAhPT0gJ21lc3NhZ2UnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgZmFsbGJhY2tUZXh0ID0gYWN0aXZpdHk/LmNoYW5uZWxEYXRhPy5bJ3dlYmNoYXQ6ZmFsbGJhY2stdGV4dCddO1xuXG4gIGlmICh0eXBlb2YgZmFsbGJhY2tUZXh0ID09PSAnc3RyaW5nJykge1xuICAgIC8vIElmIGBmYWxsYmFja1RleHRgIGlzIGFuIGVtcHR5IHN0cmluZywgd2Ugd2lsbCB0cmVhdCB0aGUgYWN0aXZpdHkgYXMgcHJlc2VudGF0aW9uYWwgYW5kIHNraXAgbmFycmF0aW5nIGl0IChyZXR1cm4gZmFsc2UpLlxuICAgIHJldHVybiBmYWxsYmFja1RleHQgfHwgZmFsc2U7XG4gIH1cblxuICBjb25zdCB0ZXh0ID0gYWN0aXZpdHk/LmNoYW5uZWxEYXRhPy5tZXNzYWdlQmFjaz8uZGlzcGxheVRleHQgfHwgYWN0aXZpdHkudGV4dDtcblxuICBpZiAoIXRleHQpIHtcbiAgICAvLyBXZSB3aWxsIGNvbnRpbnVlIHRvIG5hcnJhdGUgdGhlIGFjdGl2aXR5LCBhcyBlbXB0eS5cbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAocmVuZGVyTWFya2Rvd25Bc0hUTUwgJiYgdGV4dEZvcm1hdFRvQ29udGVudFR5cGUoYWN0aXZpdHkudGV4dEZvcm1hdCkgPT09ICd0ZXh0L21hcmtkb3duJykge1xuICAgIHJldHVybiBodG1sVGV4dEFsdGVybmF0aXZlcyhuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHJlbmRlck1hcmtkb3duQXNIVE1MKHRleHQpLCAndGV4dC9odG1sJykpXG4gICAgICAuam9pbignJylcbiAgICAgIC5yZXBsYWNlKC9cXG57Mix9L2d1LCAnXFxuJylcbiAgICAgIC50cmltKCk7XG4gIH1cblxuICByZXR1cm4gdGV4dDtcbn1cbiJdfQ==