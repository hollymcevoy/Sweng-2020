"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
exports.useSendBoxSpeechInterimsVisible = useSendBoxSpeechInterimsVisible;

var _botframeworkWebchatCore = require("botframework-webchat-core");

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _DictationInterims = _interopRequireDefault(require("./SendBox/DictationInterims"));

var _MicrophoneButton = _interopRequireDefault(require("./SendBox/MicrophoneButton"));

var _SendButton = _interopRequireDefault(require("./SendBox/SendButton"));

var _SuggestedActions = _interopRequireDefault(require("./SendBox/SuggestedActions"));

var _TextBox = _interopRequireDefault(require("./SendBox/TextBox"));

var _UploadButton = _interopRequireDefault(require("./SendBox/UploadButton"));

var _useStyleSet3 = _interopRequireDefault(require("./hooks/useStyleSet"));

var _useStyleToEmotionObject = _interopRequireDefault(require("./hooks/internal/useStyleToEmotionObject"));

var _useWebSpeechPonyfill5 = _interopRequireDefault(require("./hooks/useWebSpeechPonyfill"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var _Constants$DictateSta = _botframeworkWebchatCore.Constants.DictateState,
    DICTATING = _Constants$DictateSta.DICTATING,
    STARTING = _Constants$DictateSta.STARTING;
var useActivities = _botframeworkWebchatApi.hooks.useActivities,
    useDirection = _botframeworkWebchatApi.hooks.useDirection,
    useDictateState = _botframeworkWebchatApi.hooks.useDictateState,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var ROOT_STYLE = {
  '&.webchat__send-box': {
    '& .webchat__send-box__button': {
      flexShrink: 0
    },
    '& .webchat__send-box__dictation-interims': {
      flex: 10000
    },
    '& .webchat__send-box__main': {
      display: 'flex'
    },
    '& .webchat__send-box__microphone-button': {
      flex: 1
    },
    '& .webchat__send-box__text-box': {
      flex: 10000
    }
  }
}; // TODO: [P3] We should consider exposing core/src/definitions and use it instead

function activityIsSpeakingOrQueuedToSpeak(_ref) {
  var _ref$channelData = _ref.channelData;
  _ref$channelData = _ref$channelData === void 0 ? {} : _ref$channelData;
  var speak = _ref$channelData.speak;
  return !!speak;
}

function useSendBoxSpeechInterimsVisible() {
  var _useActivities = useActivities(),
      _useActivities2 = _slicedToArray(_useActivities, 1),
      activities = _useActivities2[0];

  var _useDictateState = useDictateState(),
      _useDictateState2 = _slicedToArray(_useDictateState, 1),
      dictateState = _useDictateState2[0];

  return [(dictateState === STARTING || dictateState === DICTATING) && !activities.filter(activityIsSpeakingOrQueuedToSpeak).length];
}

var BasicSendBox = function BasicSendBox(_ref2) {
  var className = _ref2.className;

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      _useStyleOptions2$ = _useStyleOptions2[0],
      hideUploadButton = _useStyleOptions2$.hideUploadButton,
      sendBoxButtonAlignment = _useStyleOptions2$.sendBoxButtonAlignment;

  var _useStyleSet = (0, _useStyleSet3.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      sendBoxStyleSet = _useStyleSet2[0].sendBox;

  var _useWebSpeechPonyfill = (0, _useWebSpeechPonyfill5.default)(),
      _useWebSpeechPonyfill2 = _slicedToArray(_useWebSpeechPonyfill, 1),
      _useWebSpeechPonyfill3 = _useWebSpeechPonyfill2[0];

  _useWebSpeechPonyfill3 = _useWebSpeechPonyfill3 === void 0 ? {} : _useWebSpeechPonyfill3;
  var _useWebSpeechPonyfill4 = _useWebSpeechPonyfill3.SpeechRecognition,
      SpeechRecognition = _useWebSpeechPonyfill4 === void 0 ? undefined : _useWebSpeechPonyfill4;

  var _useDirection = useDirection(),
      _useDirection2 = _slicedToArray(_useDirection, 1),
      direction = _useDirection2[0];

  var _useSendBoxSpeechInte = useSendBoxSpeechInterimsVisible(),
      _useSendBoxSpeechInte2 = _slicedToArray(_useSendBoxSpeechInte, 1),
      speechInterimsVisible = _useSendBoxSpeechInte2[0];

  var styleToEmotionObject = (0, _useStyleToEmotionObject.default)();
  var rootClassName = styleToEmotionObject(ROOT_STYLE) + '';
  var supportSpeechRecognition = !!SpeechRecognition;
  var buttonClassName = (0, _classnames.default)('webchat__send-box__button', {
    'webchat__send-box__button--align-bottom': sendBoxButtonAlignment === 'bottom',
    'webchat__send-box__button--align-stretch': sendBoxButtonAlignment !== 'bottom' && sendBoxButtonAlignment !== 'top',
    'webchat__send-box__button--align-top': sendBoxButtonAlignment === 'top'
  });
  return /*#__PURE__*/_react.default.createElement("div", {
    className: (0, _classnames.default)('webchat__send-box', sendBoxStyleSet + '', rootClassName + '', (className || '') + ''),
    dir: direction,
    role: "form"
  }, /*#__PURE__*/_react.default.createElement(_SuggestedActions.default, null), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__send-box__main"
  }, !hideUploadButton && /*#__PURE__*/_react.default.createElement(_UploadButton.default, {
    className: buttonClassName
  }), speechInterimsVisible ? /*#__PURE__*/_react.default.createElement(_DictationInterims.default, {
    className: "webchat__send-box__dictation-interims"
  }) : /*#__PURE__*/_react.default.createElement(_TextBox.default, {
    className: "webchat__send-box__text-box"
  }), supportSpeechRecognition ? /*#__PURE__*/_react.default.createElement(_MicrophoneButton.default, {
    className: (0, _classnames.default)(buttonClassName, 'webchat__send-box__microphone-button')
  }) : /*#__PURE__*/_react.default.createElement(_SendButton.default, {
    className: buttonClassName
  })));
};

BasicSendBox.defaultProps = {
  className: ''
};
BasicSendBox.propTypes = {
  className: _propTypes.default.string
};
var _default = BasicSendBox;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9CYXNpY1NlbmRCb3gudHN4Il0sIm5hbWVzIjpbIkNvbnN0YW50cyIsIkRpY3RhdGVTdGF0ZSIsIkRJQ1RBVElORyIsIlNUQVJUSU5HIiwidXNlQWN0aXZpdGllcyIsImhvb2tzIiwidXNlRGlyZWN0aW9uIiwidXNlRGljdGF0ZVN0YXRlIiwidXNlU3R5bGVPcHRpb25zIiwiUk9PVF9TVFlMRSIsImZsZXhTaHJpbmsiLCJmbGV4IiwiZGlzcGxheSIsImFjdGl2aXR5SXNTcGVha2luZ09yUXVldWVkVG9TcGVhayIsImNoYW5uZWxEYXRhIiwic3BlYWsiLCJ1c2VTZW5kQm94U3BlZWNoSW50ZXJpbXNWaXNpYmxlIiwiYWN0aXZpdGllcyIsImRpY3RhdGVTdGF0ZSIsImZpbHRlciIsImxlbmd0aCIsIkJhc2ljU2VuZEJveCIsImNsYXNzTmFtZSIsImhpZGVVcGxvYWRCdXR0b24iLCJzZW5kQm94QnV0dG9uQWxpZ25tZW50Iiwic2VuZEJveFN0eWxlU2V0Iiwic2VuZEJveCIsIlNwZWVjaFJlY29nbml0aW9uIiwidW5kZWZpbmVkIiwiZGlyZWN0aW9uIiwic3BlZWNoSW50ZXJpbXNWaXNpYmxlIiwic3R5bGVUb0Vtb3Rpb25PYmplY3QiLCJyb290Q2xhc3NOYW1lIiwic3VwcG9ydFNwZWVjaFJlY29nbml0aW9uIiwiYnV0dG9uQ2xhc3NOYW1lIiwiZGVmYXVsdFByb3BzIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwic3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7O0FBRUEsNEJBRUlBLGtDQUZKLENBQ0VDLFlBREY7QUFBQSxJQUNrQkMsU0FEbEIseUJBQ2tCQSxTQURsQjtBQUFBLElBQzZCQyxRQUQ3Qix5QkFDNkJBLFFBRDdCO0FBSUEsSUFBUUMsYUFBUixHQUEwRUMsNkJBQTFFLENBQVFELGFBQVI7QUFBQSxJQUF1QkUsWUFBdkIsR0FBMEVELDZCQUExRSxDQUF1QkMsWUFBdkI7QUFBQSxJQUFxQ0MsZUFBckMsR0FBMEVGLDZCQUExRSxDQUFxQ0UsZUFBckM7QUFBQSxJQUFzREMsZUFBdEQsR0FBMEVILDZCQUExRSxDQUFzREcsZUFBdEQ7QUFFQSxJQUFNQyxVQUFVLEdBQUc7QUFDakIseUJBQXVCO0FBQ3JCLG9DQUFnQztBQUFFQyxNQUFBQSxVQUFVLEVBQUU7QUFBZCxLQURYO0FBRXJCLGdEQUE0QztBQUFFQyxNQUFBQSxJQUFJLEVBQUU7QUFBUixLQUZ2QjtBQUdyQixrQ0FBOEI7QUFBRUMsTUFBQUEsT0FBTyxFQUFFO0FBQVgsS0FIVDtBQUlyQiwrQ0FBMkM7QUFBRUQsTUFBQUEsSUFBSSxFQUFFO0FBQVIsS0FKdEI7QUFLckIsc0NBQWtDO0FBQUVBLE1BQUFBLElBQUksRUFBRTtBQUFSO0FBTGI7QUFETixDQUFuQixDLENBVUE7O0FBQ0EsU0FBU0UsaUNBQVQsT0FBOEc7QUFBQSw4QkFBakVDLFdBQWlFO0FBQUEsbURBQXhDLEVBQXdDO0FBQUEsTUFBbERDLEtBQWtELG9CQUFsREEsS0FBa0Q7QUFDNUcsU0FBTyxDQUFDLENBQUNBLEtBQVQ7QUFDRDs7QUFFRCxTQUFTQywrQkFBVCxHQUFzRDtBQUNwRCx1QkFBcUJaLGFBQWEsRUFBbEM7QUFBQTtBQUFBLE1BQU9hLFVBQVA7O0FBQ0EseUJBQXVCVixlQUFlLEVBQXRDO0FBQUE7QUFBQSxNQUFPVyxZQUFQOztBQUVBLFNBQU8sQ0FDTCxDQUFDQSxZQUFZLEtBQUtmLFFBQWpCLElBQTZCZSxZQUFZLEtBQUtoQixTQUEvQyxLQUNFLENBQUNlLFVBQVUsQ0FBQ0UsTUFBWCxDQUFrQk4saUNBQWxCLEVBQXFETyxNQUZuRCxDQUFQO0FBSUQ7O0FBTUQsSUFBTUMsWUFBbUMsR0FBRyxTQUF0Q0EsWUFBc0MsUUFBbUI7QUFBQSxNQUFoQkMsU0FBZ0IsU0FBaEJBLFNBQWdCOztBQUM3RCx5QkFBdURkLGVBQWUsRUFBdEU7QUFBQTtBQUFBO0FBQUEsTUFBU2UsZ0JBQVQsc0JBQVNBLGdCQUFUO0FBQUEsTUFBMkJDLHNCQUEzQixzQkFBMkJBLHNCQUEzQjs7QUFDQSxxQkFBdUMsNEJBQXZDO0FBQUE7QUFBQSxNQUFrQkMsZUFBbEIsb0JBQVNDLE9BQVQ7O0FBQ0EsOEJBQWlELHFDQUFqRDtBQUFBO0FBQUE7O0FBQUEsK0RBQTJDLEVBQTNDO0FBQUEsc0RBQVNDLGlCQUFUO0FBQUEsTUFBU0EsaUJBQVQsdUNBQTZCQyxTQUE3Qjs7QUFDQSxzQkFBb0J0QixZQUFZLEVBQWhDO0FBQUE7QUFBQSxNQUFPdUIsU0FBUDs7QUFDQSw4QkFBZ0NiLCtCQUErQixFQUEvRDtBQUFBO0FBQUEsTUFBT2MscUJBQVA7O0FBQ0EsTUFBTUMsb0JBQW9CLEdBQUcsdUNBQTdCO0FBRUEsTUFBTUMsYUFBYSxHQUFHRCxvQkFBb0IsQ0FBQ3RCLFVBQUQsQ0FBcEIsR0FBbUMsRUFBekQ7QUFFQSxNQUFNd0Isd0JBQXdCLEdBQUcsQ0FBQyxDQUFDTixpQkFBbkM7QUFFQSxNQUFNTyxlQUFlLEdBQUcseUJBQVcsMkJBQVgsRUFBd0M7QUFDOUQsK0NBQTJDVixzQkFBc0IsS0FBSyxRQURSO0FBRTlELGdEQUE0Q0Esc0JBQXNCLEtBQUssUUFBM0IsSUFBdUNBLHNCQUFzQixLQUFLLEtBRmhEO0FBRzlELDRDQUF3Q0Esc0JBQXNCLEtBQUs7QUFITCxHQUF4QyxDQUF4QjtBQU1BLHNCQUNFO0FBQ0UsSUFBQSxTQUFTLEVBQUUseUJBQVcsbUJBQVgsRUFBZ0NDLGVBQWUsR0FBRyxFQUFsRCxFQUFzRE8sYUFBYSxHQUFHLEVBQXRFLEVBQTBFLENBQUNWLFNBQVMsSUFBSSxFQUFkLElBQW9CLEVBQTlGLENBRGI7QUFFRSxJQUFBLEdBQUcsRUFBRU8sU0FGUDtBQUdFLElBQUEsSUFBSSxFQUFDO0FBSFAsa0JBS0UsNkJBQUMseUJBQUQsT0FMRixlQU1FO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixLQUNHLENBQUNOLGdCQUFELGlCQUFxQiw2QkFBQyxxQkFBRDtBQUFjLElBQUEsU0FBUyxFQUFFVztBQUF6QixJQUR4QixFQUVHSixxQkFBcUIsZ0JBQ3BCLDZCQUFDLDBCQUFEO0FBQW1CLElBQUEsU0FBUyxFQUFDO0FBQTdCLElBRG9CLGdCQUdwQiw2QkFBQyxnQkFBRDtBQUFTLElBQUEsU0FBUyxFQUFDO0FBQW5CLElBTEosRUFPR0csd0JBQXdCLGdCQUN2Qiw2QkFBQyx5QkFBRDtBQUFrQixJQUFBLFNBQVMsRUFBRSx5QkFBV0MsZUFBWCxFQUE0QixzQ0FBNUI7QUFBN0IsSUFEdUIsZ0JBR3ZCLDZCQUFDLG1CQUFEO0FBQVksSUFBQSxTQUFTLEVBQUVBO0FBQXZCLElBVkosQ0FORixDQURGO0FBc0JELENBeENEOztBQTBDQWIsWUFBWSxDQUFDYyxZQUFiLEdBQTRCO0FBQzFCYixFQUFBQSxTQUFTLEVBQUU7QUFEZSxDQUE1QjtBQUlBRCxZQUFZLENBQUNlLFNBQWIsR0FBeUI7QUFDdkJkLEVBQUFBLFNBQVMsRUFBRWUsbUJBQVVDO0FBREUsQ0FBekI7ZUFJZWpCLFkiLCJzb3VyY2VSb290IjoiY29tcG9uZW50Oi8vLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0YW50cyB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWNvcmUnO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICdib3RmcmFtZXdvcmstd2ViY2hhdC1hcGknO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFJlYWN0LCB7IEZDIH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgRGljdGF0aW9uSW50ZXJpbXMgZnJvbSAnLi9TZW5kQm94L0RpY3RhdGlvbkludGVyaW1zJztcbmltcG9ydCBNaWNyb3Bob25lQnV0dG9uIGZyb20gJy4vU2VuZEJveC9NaWNyb3Bob25lQnV0dG9uJztcbmltcG9ydCBTZW5kQnV0dG9uIGZyb20gJy4vU2VuZEJveC9TZW5kQnV0dG9uJztcbmltcG9ydCBTdWdnZXN0ZWRBY3Rpb25zIGZyb20gJy4vU2VuZEJveC9TdWdnZXN0ZWRBY3Rpb25zJztcbmltcG9ydCBUZXh0Qm94IGZyb20gJy4vU2VuZEJveC9UZXh0Qm94JztcbmltcG9ydCBVcGxvYWRCdXR0b24gZnJvbSAnLi9TZW5kQm94L1VwbG9hZEJ1dHRvbic7XG5pbXBvcnQgdXNlU3R5bGVTZXQgZnJvbSAnLi9ob29rcy91c2VTdHlsZVNldCc7XG5pbXBvcnQgdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QgZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VTdHlsZVRvRW1vdGlvbk9iamVjdCc7XG5pbXBvcnQgdXNlV2ViU3BlZWNoUG9ueWZpbGwgZnJvbSAnLi9ob29rcy91c2VXZWJTcGVlY2hQb255ZmlsbCc7XG5cbmNvbnN0IHtcbiAgRGljdGF0ZVN0YXRlOiB7IERJQ1RBVElORywgU1RBUlRJTkcgfVxufSA9IENvbnN0YW50cztcblxuY29uc3QgeyB1c2VBY3Rpdml0aWVzLCB1c2VEaXJlY3Rpb24sIHVzZURpY3RhdGVTdGF0ZSwgdXNlU3R5bGVPcHRpb25zIH0gPSBob29rcztcblxuY29uc3QgUk9PVF9TVFlMRSA9IHtcbiAgJyYud2ViY2hhdF9fc2VuZC1ib3gnOiB7XG4gICAgJyYgLndlYmNoYXRfX3NlbmQtYm94X19idXR0b24nOiB7IGZsZXhTaHJpbms6IDAgfSxcbiAgICAnJiAud2ViY2hhdF9fc2VuZC1ib3hfX2RpY3RhdGlvbi1pbnRlcmltcyc6IHsgZmxleDogMTAwMDAgfSxcbiAgICAnJiAud2ViY2hhdF9fc2VuZC1ib3hfX21haW4nOiB7IGRpc3BsYXk6ICdmbGV4JyB9LFxuICAgICcmIC53ZWJjaGF0X19zZW5kLWJveF9fbWljcm9waG9uZS1idXR0b24nOiB7IGZsZXg6IDEgfSxcbiAgICAnJiAud2ViY2hhdF9fc2VuZC1ib3hfX3RleHQtYm94JzogeyBmbGV4OiAxMDAwMCB9XG4gIH1cbn07XG5cbi8vIFRPRE86IFtQM10gV2Ugc2hvdWxkIGNvbnNpZGVyIGV4cG9zaW5nIGNvcmUvc3JjL2RlZmluaXRpb25zIGFuZCB1c2UgaXQgaW5zdGVhZFxuZnVuY3Rpb24gYWN0aXZpdHlJc1NwZWFraW5nT3JRdWV1ZWRUb1NwZWFrKHsgY2hhbm5lbERhdGE6IHsgc3BlYWsgfSA9IHt9IH06IHsgY2hhbm5lbERhdGE6IHsgc3BlYWs/OiBhbnkgfSB9KSB7XG4gIHJldHVybiAhIXNwZWFrO1xufVxuXG5mdW5jdGlvbiB1c2VTZW5kQm94U3BlZWNoSW50ZXJpbXNWaXNpYmxlKCk6IFtib29sZWFuXSB7XG4gIGNvbnN0IFthY3Rpdml0aWVzXSA9IHVzZUFjdGl2aXRpZXMoKTtcbiAgY29uc3QgW2RpY3RhdGVTdGF0ZV0gPSB1c2VEaWN0YXRlU3RhdGUoKTtcblxuICByZXR1cm4gW1xuICAgIChkaWN0YXRlU3RhdGUgPT09IFNUQVJUSU5HIHx8IGRpY3RhdGVTdGF0ZSA9PT0gRElDVEFUSU5HKSAmJlxuICAgICAgIWFjdGl2aXRpZXMuZmlsdGVyKGFjdGl2aXR5SXNTcGVha2luZ09yUXVldWVkVG9TcGVhaykubGVuZ3RoXG4gIF07XG59XG5cbnR5cGUgQmFzaWNTZW5kQm94UHJvcHMgPSB7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbn07XG5cbmNvbnN0IEJhc2ljU2VuZEJveDogRkM8QmFzaWNTZW5kQm94UHJvcHM+ID0gKHsgY2xhc3NOYW1lIH0pID0+IHtcbiAgY29uc3QgW3sgaGlkZVVwbG9hZEJ1dHRvbiwgc2VuZEJveEJ1dHRvbkFsaWdubWVudCB9XSA9IHVzZVN0eWxlT3B0aW9ucygpO1xuICBjb25zdCBbeyBzZW5kQm94OiBzZW5kQm94U3R5bGVTZXQgfV0gPSB1c2VTdHlsZVNldCgpO1xuICBjb25zdCBbeyBTcGVlY2hSZWNvZ25pdGlvbiA9IHVuZGVmaW5lZCB9ID0ge31dID0gdXNlV2ViU3BlZWNoUG9ueWZpbGwoKTtcbiAgY29uc3QgW2RpcmVjdGlvbl0gPSB1c2VEaXJlY3Rpb24oKTtcbiAgY29uc3QgW3NwZWVjaEludGVyaW1zVmlzaWJsZV0gPSB1c2VTZW5kQm94U3BlZWNoSW50ZXJpbXNWaXNpYmxlKCk7XG4gIGNvbnN0IHN0eWxlVG9FbW90aW9uT2JqZWN0ID0gdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QoKTtcblxuICBjb25zdCByb290Q2xhc3NOYW1lID0gc3R5bGVUb0Vtb3Rpb25PYmplY3QoUk9PVF9TVFlMRSkgKyAnJztcblxuICBjb25zdCBzdXBwb3J0U3BlZWNoUmVjb2duaXRpb24gPSAhIVNwZWVjaFJlY29nbml0aW9uO1xuXG4gIGNvbnN0IGJ1dHRvbkNsYXNzTmFtZSA9IGNsYXNzTmFtZXMoJ3dlYmNoYXRfX3NlbmQtYm94X19idXR0b24nLCB7XG4gICAgJ3dlYmNoYXRfX3NlbmQtYm94X19idXR0b24tLWFsaWduLWJvdHRvbSc6IHNlbmRCb3hCdXR0b25BbGlnbm1lbnQgPT09ICdib3R0b20nLFxuICAgICd3ZWJjaGF0X19zZW5kLWJveF9fYnV0dG9uLS1hbGlnbi1zdHJldGNoJzogc2VuZEJveEJ1dHRvbkFsaWdubWVudCAhPT0gJ2JvdHRvbScgJiYgc2VuZEJveEJ1dHRvbkFsaWdubWVudCAhPT0gJ3RvcCcsXG4gICAgJ3dlYmNoYXRfX3NlbmQtYm94X19idXR0b24tLWFsaWduLXRvcCc6IHNlbmRCb3hCdXR0b25BbGlnbm1lbnQgPT09ICd0b3AnXG4gIH0pO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKCd3ZWJjaGF0X19zZW5kLWJveCcsIHNlbmRCb3hTdHlsZVNldCArICcnLCByb290Q2xhc3NOYW1lICsgJycsIChjbGFzc05hbWUgfHwgJycpICsgJycpfVxuICAgICAgZGlyPXtkaXJlY3Rpb259XG4gICAgICByb2xlPVwiZm9ybVwiXG4gICAgPlxuICAgICAgPFN1Z2dlc3RlZEFjdGlvbnMgLz5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fc2VuZC1ib3hfX21haW5cIj5cbiAgICAgICAgeyFoaWRlVXBsb2FkQnV0dG9uICYmIDxVcGxvYWRCdXR0b24gY2xhc3NOYW1lPXtidXR0b25DbGFzc05hbWV9IC8+fVxuICAgICAgICB7c3BlZWNoSW50ZXJpbXNWaXNpYmxlID8gKFxuICAgICAgICAgIDxEaWN0YXRpb25JbnRlcmltcyBjbGFzc05hbWU9XCJ3ZWJjaGF0X19zZW5kLWJveF9fZGljdGF0aW9uLWludGVyaW1zXCIgLz5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8VGV4dEJveCBjbGFzc05hbWU9XCJ3ZWJjaGF0X19zZW5kLWJveF9fdGV4dC1ib3hcIiAvPlxuICAgICAgICApfVxuICAgICAgICB7c3VwcG9ydFNwZWVjaFJlY29nbml0aW9uID8gKFxuICAgICAgICAgIDxNaWNyb3Bob25lQnV0dG9uIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhidXR0b25DbGFzc05hbWUsICd3ZWJjaGF0X19zZW5kLWJveF9fbWljcm9waG9uZS1idXR0b24nKX0gLz5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8U2VuZEJ1dHRvbiBjbGFzc05hbWU9e2J1dHRvbkNsYXNzTmFtZX0gLz5cbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufTtcblxuQmFzaWNTZW5kQm94LmRlZmF1bHRQcm9wcyA9IHtcbiAgY2xhc3NOYW1lOiAnJ1xufTtcblxuQmFzaWNTZW5kQm94LnByb3BUeXBlcyA9IHtcbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nXG59O1xuXG5leHBvcnQgZGVmYXVsdCBCYXNpY1NlbmRCb3g7XG5cbmV4cG9ydCB7IHVzZVNlbmRCb3hTcGVlY2hJbnRlcmltc1Zpc2libGUgfTtcbiJdfQ==