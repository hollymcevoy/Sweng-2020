{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _reactDictateButton = require(\"react-dictate-button\");\n\nvar _botframeworkWebchatCore = require(\"botframework-webchat-core\");\n\nvar _botframeworkWebchatApi = require(\"botframework-webchat-api\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _useResumeAudioContext = _interopRequireDefault(require(\"./hooks/internal/useResumeAudioContext\"));\n\nvar _useSettableDictateAbortable = _interopRequireDefault(require(\"./hooks/internal/useSettableDictateAbortable\"));\n\nvar _useWebSpeechPonyfill4 = _interopRequireDefault(require(\"./hooks/useWebSpeechPonyfill\"));\n\nvar _useSetDictateState = _interopRequireDefault(require(\"botframework-webchat-api/lib/hooks/internal/useSetDictateState\"));\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nvar useActivities = _botframeworkWebchatApi.hooks.useActivities,\n    useDictateInterims = _botframeworkWebchatApi.hooks.useDictateInterims,\n    useDictateState = _botframeworkWebchatApi.hooks.useDictateState,\n    useDisabled = _botframeworkWebchatApi.hooks.useDisabled,\n    useEmitTypingIndicator = _botframeworkWebchatApi.hooks.useEmitTypingIndicator,\n    useLanguage = _botframeworkWebchatApi.hooks.useLanguage,\n    useSendBoxValue = _botframeworkWebchatApi.hooks.useSendBoxValue,\n    useSendTypingIndicator = _botframeworkWebchatApi.hooks.useSendTypingIndicator,\n    useShouldSpeakIncomingActivity = _botframeworkWebchatApi.hooks.useShouldSpeakIncomingActivity,\n    useStopDictate = _botframeworkWebchatApi.hooks.useStopDictate,\n    useSubmitSendBox = _botframeworkWebchatApi.hooks.useSubmitSendBox;\nvar _Constants$DictateSta = _botframeworkWebchatCore.Constants.DictateState,\n    DICTATING = _Constants$DictateSta.DICTATING,\n    IDLE = _Constants$DictateSta.IDLE,\n    STARTING = _Constants$DictateSta.STARTING;\n\nvar Dictation = function Dictation(_ref) {\n  var onError = _ref.onError;\n\n  var _useSettableDictateAb = (0, _useSettableDictateAbortable.default)(),\n      _useSettableDictateAb2 = _slicedToArray(_useSettableDictateAb, 2),\n      setDictateAbortable = _useSettableDictateAb2[1];\n\n  var _useDictateInterims = useDictateInterims(),\n      _useDictateInterims2 = _slicedToArray(_useDictateInterims, 2),\n      setDictateInterims = _useDictateInterims2[1];\n\n  var _useSendBoxValue = useSendBoxValue(),\n      _useSendBoxValue2 = _slicedToArray(_useSendBoxValue, 2),\n      setSendBox = _useSendBoxValue2[1];\n\n  var _useShouldSpeakIncomi = useShouldSpeakIncomingActivity(),\n      _useShouldSpeakIncomi2 = _slicedToArray(_useShouldSpeakIncomi, 2),\n      setShouldSpeakIncomingActivity = _useShouldSpeakIncomi2[1];\n\n  var _useWebSpeechPonyfill = (0, _useWebSpeechPonyfill4.default)(),\n      _useWebSpeechPonyfill2 = _slicedToArray(_useWebSpeechPonyfill, 1),\n      _useWebSpeechPonyfill3 = _useWebSpeechPonyfill2[0];\n\n  _useWebSpeechPonyfill3 = _useWebSpeechPonyfill3 === void 0 ? {} : _useWebSpeechPonyfill3;\n  var SpeechGrammarList = _useWebSpeechPonyfill3.SpeechGrammarList,\n      SpeechRecognition = _useWebSpeechPonyfill3.SpeechRecognition;\n\n  var _useActivities = useActivities(),\n      _useActivities2 = _slicedToArray(_useActivities, 1),\n      activities = _useActivities2[0];\n\n  var _useDictateState = useDictateState(),\n      _useDictateState2 = _slicedToArray(_useDictateState, 1),\n      dictateState = _useDictateState2[0];\n\n  var _useDisabled = useDisabled(),\n      _useDisabled2 = _slicedToArray(_useDisabled, 1),\n      disabled = _useDisabled2[0];\n\n  var _useSendTypingIndicat = useSendTypingIndicator(),\n      _useSendTypingIndicat2 = _slicedToArray(_useSendTypingIndicat, 1),\n      sendTypingIndicator = _useSendTypingIndicat2[0];\n\n  var _useLanguage = useLanguage('speech'),\n      _useLanguage2 = _slicedToArray(_useLanguage, 1),\n      speechLanguage = _useLanguage2[0];\n\n  var emitTypingIndicator = useEmitTypingIndicator();\n  var resumeAudioContext = (0, _useResumeAudioContext.default)();\n  var setDictateState = (0, _useSetDictateState.default)();\n  var stopDictate = useStopDictate();\n  var submitSendBox = useSubmitSendBox();\n  var numSpeakingActivities = (0, _react.useMemo)(function () {\n    return activities.filter(function (_ref2) {\n      var _ref2$channelData = _ref2.channelData;\n      _ref2$channelData = _ref2$channelData === void 0 ? {} : _ref2$channelData;\n      var speak = _ref2$channelData.speak;\n      return speak;\n    }).length;\n  }, [activities]);\n  var handleDictate = (0, _react.useCallback)(function (_ref3) {\n    var _ref3$result = _ref3.result;\n    _ref3$result = _ref3$result === void 0 ? {} : _ref3$result;\n    var confidence = _ref3$result.confidence,\n        transcript = _ref3$result.transcript;\n\n    if (dictateState === DICTATING || dictateState === STARTING) {\n      setDictateInterims([]);\n      setDictateState(IDLE);\n      stopDictate();\n\n      if (transcript) {\n        setSendBox(transcript);\n        submitSendBox('speech', {\n          channelData: {\n            speech: {\n              alternatives: [{\n                confidence: confidence,\n                transcript: transcript\n              }]\n            }\n          }\n        });\n        setShouldSpeakIncomingActivity(true);\n      }\n    }\n  }, [dictateState, setDictateInterims, setDictateState, stopDictate, setSendBox, submitSendBox, setShouldSpeakIncomingActivity]);\n  var handleDictating = (0, _react.useCallback)(function (_ref4) {\n    var abortable = _ref4.abortable,\n        _ref4$results = _ref4.results,\n        results = _ref4$results === void 0 ? [] : _ref4$results;\n\n    if (dictateState === DICTATING || dictateState === STARTING) {\n      var interims = results.map(function (_ref5) {\n        var transcript = _ref5.transcript;\n        return transcript;\n      });\n      setDictateAbortable(abortable);\n      setDictateInterims(interims);\n      setDictateState(DICTATING);\n      sendTypingIndicator && emitTypingIndicator();\n    }\n  }, [dictateState, emitTypingIndicator, sendTypingIndicator, setDictateAbortable, setDictateInterims, setDictateState]);\n  var handleError = (0, _react.useCallback)(function (event) {\n    dictateState !== IDLE && setDictateState(IDLE);\n    (dictateState === DICTATING || dictateState === STARTING) && stopDictate();\n    onError && onError(event);\n  }, [dictateState, onError, setDictateState, stopDictate]);\n  (0, _react.useEffect)(function () {\n    window.addEventListener('pointerdown', resumeAudioContext);\n    return function () {\n      return window.removeEventListener('pointerdown', resumeAudioContext);\n    };\n  }, [resumeAudioContext]);\n  return /*#__PURE__*/_react.default.createElement(_reactDictateButton.Composer, {\n    lang: speechLanguage,\n    onDictate: handleDictate,\n    onError: handleError,\n    onProgress: handleDictating,\n    speechGrammarList: SpeechGrammarList,\n    speechRecognition: SpeechRecognition,\n    started: !disabled && (dictateState === STARTING || dictateState === DICTATING) && !numSpeakingActivities\n  });\n};\n\nDictation.defaultProps = {\n  onError: undefined\n};\nDictation.propTypes = {\n  onError: _propTypes.default.func\n};\nvar _default = Dictation;\nexports.default = _default;","map":{"version":3,"mappings":"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","names":["useActivities","hooks","useDictateInterims","useDictateState","useDisabled","useEmitTypingIndicator","useLanguage","useSendBoxValue","useSendTypingIndicator","useShouldSpeakIncomingActivity","useStopDictate","useSubmitSendBox","Constants","DictateState","DICTATING","IDLE","STARTING","Dictation","onError","setDictateAbortable","setDictateInterims","setSendBox","setShouldSpeakIncomingActivity","_useWebSpeechPonyfill3","SpeechGrammarList","SpeechRecognition","activities","dictateState","disabled","sendTypingIndicator","speechLanguage","emitTypingIndicator","resumeAudioContext","setDictateState","stopDictate","submitSendBox","numSpeakingActivities","filter","channelData","_ref2$channelData","speak","length","handleDictate","result","_ref3$result","confidence","transcript","speech","alternatives","handleDictating","abortable","results","interims","map","handleError","event","window","addEventListener","removeEventListener","_react","_reactDictateButton","lang","onDictate","onProgress","speechGrammarList","speechRecognition","started","defaultProps","undefined","propTypes","PropTypes","func"],"sources":["/Users/dylanmurray/Sweng-2022/front/node_modules/botframework-webchat-component/lib/src/Dictation.js"],"sourcesContent":["import { Composer as DictateComposer } from 'react-dictate-button';\nimport { Constants } from 'botframework-webchat-core';\nimport { hooks } from 'botframework-webchat-api';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useEffect, useMemo } from 'react';\n\nimport useResumeAudioContext from './hooks/internal/useResumeAudioContext';\nimport useSettableDictateAbortable from './hooks/internal/useSettableDictateAbortable';\nimport useWebSpeechPonyfill from './hooks/useWebSpeechPonyfill';\n\n// TODO: [P1] #3350 No /lib/, we need to move setDictateState from bf-wc-core (Redux) to React Context.\nimport useSetDictateState from 'botframework-webchat-api/lib/hooks/internal/useSetDictateState';\n\nconst {\n  useActivities,\n  useDictateInterims,\n  useDictateState,\n  useDisabled,\n  useEmitTypingIndicator,\n  useLanguage,\n  useSendBoxValue,\n  useSendTypingIndicator,\n  useShouldSpeakIncomingActivity,\n  useStopDictate,\n  useSubmitSendBox\n} = hooks;\n\nconst {\n  DictateState: { DICTATING, IDLE, STARTING }\n} = Constants;\n\nconst Dictation = ({ onError }) => {\n  const [, setDictateAbortable] = useSettableDictateAbortable();\n  const [, setDictateInterims] = useDictateInterims();\n  const [, setSendBox] = useSendBoxValue();\n  const [, setShouldSpeakIncomingActivity] = useShouldSpeakIncomingActivity();\n  const [{ SpeechGrammarList, SpeechRecognition } = {}] = useWebSpeechPonyfill();\n  const [activities] = useActivities();\n  const [dictateState] = useDictateState();\n  const [disabled] = useDisabled();\n  const [sendTypingIndicator] = useSendTypingIndicator();\n  const [speechLanguage] = useLanguage('speech');\n  const emitTypingIndicator = useEmitTypingIndicator();\n  const resumeAudioContext = useResumeAudioContext();\n  const setDictateState = useSetDictateState();\n  const stopDictate = useStopDictate();\n  const submitSendBox = useSubmitSendBox();\n\n  const numSpeakingActivities = useMemo(\n    () => activities.filter(({ channelData: { speak } = {} }) => speak).length,\n    [activities]\n  );\n\n  const handleDictate = useCallback(\n    ({ result: { confidence, transcript } = {} }) => {\n      if (dictateState === DICTATING || dictateState === STARTING) {\n        setDictateInterims([]);\n        setDictateState(IDLE);\n        stopDictate();\n\n        if (transcript) {\n          setSendBox(transcript);\n          submitSendBox('speech', { channelData: { speech: { alternatives: [{ confidence, transcript }] } } });\n          setShouldSpeakIncomingActivity(true);\n        }\n      }\n    },\n    [\n      dictateState,\n      setDictateInterims,\n      setDictateState,\n      stopDictate,\n      setSendBox,\n      submitSendBox,\n      setShouldSpeakIncomingActivity\n    ]\n  );\n\n  const handleDictating = useCallback(\n    ({ abortable, results = [] }) => {\n      if (dictateState === DICTATING || dictateState === STARTING) {\n        const interims = results.map(({ transcript }) => transcript);\n\n        setDictateAbortable(abortable);\n        setDictateInterims(interims);\n        setDictateState(DICTATING);\n        sendTypingIndicator && emitTypingIndicator();\n      }\n    },\n    [dictateState, emitTypingIndicator, sendTypingIndicator, setDictateAbortable, setDictateInterims, setDictateState]\n  );\n\n  const handleError = useCallback(\n    event => {\n      dictateState !== IDLE && setDictateState(IDLE);\n      (dictateState === DICTATING || dictateState === STARTING) && stopDictate();\n\n      onError && onError(event);\n    },\n    [dictateState, onError, setDictateState, stopDictate]\n  );\n\n  useEffect(() => {\n    window.addEventListener('pointerdown', resumeAudioContext);\n\n    return () => window.removeEventListener('pointerdown', resumeAudioContext);\n  }, [resumeAudioContext]);\n\n  return (\n    <DictateComposer\n      lang={speechLanguage}\n      onDictate={handleDictate}\n      onError={handleError}\n      onProgress={handleDictating}\n      speechGrammarList={SpeechGrammarList}\n      speechRecognition={SpeechRecognition}\n      started={!disabled && (dictateState === STARTING || dictateState === DICTATING) && !numSpeakingActivities}\n    />\n  );\n};\n\nDictation.defaultProps = {\n  onError: undefined\n};\n\nDictation.propTypes = {\n  onError: PropTypes.func\n};\n\nexport default Dictation;\n"]},"metadata":{},"sourceType":"script"}