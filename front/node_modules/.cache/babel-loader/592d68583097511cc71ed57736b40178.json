{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/dylanmurray/Sweng-2022/front/node_modules/@babel/runtime/regenerator/index.js\");\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.connectUploadButton = void 0;\n\nvar _botframeworkWebchatApi = require(\"botframework-webchat-api\");\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _AttachmentIcon = _interopRequireDefault(require(\"./Assets/AttachmentIcon\"));\n\nvar _connectToWebChat = _interopRequireDefault(require(\"../connectToWebChat\"));\n\nvar _index = _interopRequireDefault(require(\"../Utils/downscaleImageToDataURL/index\"));\n\nvar _IconButton = _interopRequireDefault(require(\"./IconButton\"));\n\nvar _useSendFiles = _interopRequireDefault(require(\"../hooks/useSendFiles\"));\n\nvar _useStyleSet3 = _interopRequireDefault(require(\"../hooks/useStyleSet\"));\n\nvar _useStyleToEmotionObject = _interopRequireDefault(require(\"../hooks/internal/useStyleToEmotionObject\"));\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nvar useDisabled = _botframeworkWebchatApi.hooks.useDisabled,\n    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer;\nvar ROOT_STYLE = {\n  '&.webchat__upload-button': {\n    display: 'flex',\n    overflow: 'hidden',\n    position: 'relative',\n    '& .webchat__upload-button--file-input': {\n      height: 0,\n      width: 0,\n      opacity: 0,\n      position: 'absolute',\n      left: 0,\n      top: 0\n    }\n  }\n};\n\nvar PREVENT_DEFAULT_HANDLER = function PREVENT_DEFAULT_HANDLER(event) {\n  return event.preventDefault();\n};\n\nfunction makeThumbnail(_x, _x2, _x3, _x4, _x5) {\n  return _makeThumbnail.apply(this, arguments);\n}\n\nfunction _makeThumbnail() {\n  _makeThumbnail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(file, width, height, contentType, quality) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!/\\.(gif|jpe?g|png)$/i.test(file.name)) {\n              _context3.next = 10;\n              break;\n            }\n\n            _context3.prev = 1;\n            _context3.next = 4;\n            return (0, _index.default)(file, width, height, contentType, quality);\n\n          case 4:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](1);\n            console.warn(\"Web Chat: Failed to downscale image due to \".concat(_context3.t0, \".\"));\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[1, 7]]);\n  }));\n  return _makeThumbnail.apply(this, arguments);\n}\n\nvar connectUploadButton = function connectUploadButton() {\n  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {\n    selectors[_key] = arguments[_key];\n  }\n\n  return _connectToWebChat.default.apply(void 0, [function (_ref) {\n    var disabled = _ref.disabled,\n        language = _ref.language,\n        _sendFiles = _ref.sendFiles,\n        _ref$styleSet$options = _ref.styleSet.options,\n        enableUploadThumbnail = _ref$styleSet$options.enableUploadThumbnail,\n        uploadThumbnailContentType = _ref$styleSet$options.uploadThumbnailContentType,\n        uploadThumbnailHeight = _ref$styleSet$options.uploadThumbnailHeight,\n        uploadThumbnailQuality = _ref$styleSet$options.uploadThumbnailQuality,\n        uploadThumbnailWidth = _ref$styleSet$options.uploadThumbnailWidth;\n    return {\n      disabled: disabled,\n      language: language,\n      sendFiles: function () {\n        var _sendFiles2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(files) {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  if (!(files && files.length)) {\n                    _context2.next = 6;\n                    break;\n                  }\n\n                  _context2.t0 = _sendFiles;\n                  _context2.next = 4;\n                  return Promise.all([].map.call(files, /*#__PURE__*/function () {\n                    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(file) {\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              _context.t0 = _objectSpread;\n                              _context.t1 = {\n                                name: file.name,\n                                size: file.size,\n                                url: window.URL.createObjectURL(file)\n                              };\n                              _context.t2 = enableUploadThumbnail;\n\n                              if (!_context.t2) {\n                                _context.next = 8;\n                                break;\n                              }\n\n                              _context.next = 6;\n                              return makeThumbnail(file, uploadThumbnailWidth, uploadThumbnailHeight, uploadThumbnailContentType, uploadThumbnailQuality);\n\n                            case 6:\n                              _context.t3 = _context.sent;\n                              _context.t2 = {\n                                thumbnail: _context.t3\n                              };\n\n                            case 8:\n                              _context.t4 = _context.t2;\n                              return _context.abrupt(\"return\", (0, _context.t0)(_context.t1, _context.t4));\n\n                            case 10:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee);\n                    }));\n\n                    return function (_x7) {\n                      return _ref2.apply(this, arguments);\n                    };\n                  }()));\n\n                case 4:\n                  _context2.t1 = _context2.sent;\n                  (0, _context2.t0)(_context2.t1);\n\n                case 6:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        function sendFiles(_x6) {\n          return _sendFiles2.apply(this, arguments);\n        }\n\n        return sendFiles;\n      }()\n    };\n  }].concat(selectors));\n};\n\nexports.connectUploadButton = connectUploadButton;\n\nvar UploadButton = function UploadButton(_ref3) {\n  var className = _ref3.className;\n\n  var _useStyleSet = (0, _useStyleSet3.default)(),\n      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),\n      uploadButtonStyleSet = _useStyleSet2[0].uploadButton;\n\n  var _useDisabled = useDisabled(),\n      _useDisabled2 = _slicedToArray(_useDisabled, 1),\n      disabled = _useDisabled2[0];\n\n  var inputRef = (0, _react.useRef)();\n  var localize = useLocalizer();\n  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';\n  var sendFiles = (0, _useSendFiles.default)();\n  var current = inputRef.current;\n  var uploadFileString = localize('TEXT_INPUT_UPLOAD_BUTTON_ALT');\n  var handleClick = (0, _react.useCallback)(function () {\n    current && current.click();\n  }, [current]);\n  var handleFileChange = (0, _react.useCallback)(function (_ref4) {\n    var files = _ref4.target.files;\n    sendFiles(files);\n\n    if (current) {\n      current.value = null;\n    }\n  }, [current, sendFiles]);\n  return /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: (0, _classnames.default)(rootClassName, 'webchat__upload-button', uploadButtonStyleSet + '', className)\n  }, /*#__PURE__*/_react.default.createElement(\"input\", {\n    \"aria-disabled\": disabled,\n    \"aria-hidden\": \"true\",\n    className: \"webchat__upload-button--file-input\",\n    multiple: true,\n    onChange: disabled ? undefined : handleFileChange,\n    onClick: disabled ? PREVENT_DEFAULT_HANDLER : undefined,\n    readOnly: disabled,\n    ref: inputRef,\n    role: \"button\",\n    tabIndex: -1,\n    type: \"file\"\n  }), /*#__PURE__*/_react.default.createElement(_IconButton.default, {\n    alt: uploadFileString,\n    \"aria-label\": uploadFileString,\n    disabled: disabled,\n    onClick: handleClick\n  }, /*#__PURE__*/_react.default.createElement(_AttachmentIcon.default, null)));\n};\n\nUploadButton.defaultProps = {\n  className: undefined\n};\nUploadButton.propTypes = {\n  className: _propTypes.default.string\n};\nvar _default = UploadButton;\nexports.default = _default;","map":{"version":3,"mappings":"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","names":["useDisabled","hooks","useLocalizer","ROOT_STYLE","display","overflow","position","height","width","opacity","left","top","PREVENT_DEFAULT_HANDLER","event","preventDefault","makeThumbnail","file","contentType","quality","test","name","_context3","console","warn","connectUploadButton","selectors","arguments","connectToWebChat","disabled","language","sendFiles","styleSet","options","enableUploadThumbnail","uploadThumbnailContentType","uploadThumbnailHeight","uploadThumbnailQuality","uploadThumbnailWidth","files","length","_context2","Promise","all","map","call","_context","size","url","window","URL","createObjectURL","thumbnail","UploadButton","className","uploadButtonStyleSet","uploadButton","inputRef","localize","rootClassName","current","uploadFileString","handleClick","click","handleFileChange","target","value","_react","multiple","onChange","undefined","onClick","readOnly","ref","role","tabIndex","type","_IconButton","alt","_AttachmentIcon","defaultProps","propTypes","PropTypes","string"],"sources":["/Users/dylanmurray/Sweng-2022/front/node_modules/botframework-webchat-component/lib/src/SendBox/UploadButton.tsx"],"sourcesContent":["import { hooks } from 'botframework-webchat-api';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { FC, useCallback, useRef } from 'react';\n\nimport AttachmentIcon from './Assets/AttachmentIcon';\nimport connectToWebChat from '../connectToWebChat';\nimport downscaleImageToDataURL from '../Utils/downscaleImageToDataURL/index';\nimport IconButton from './IconButton';\nimport useSendFiles from '../hooks/useSendFiles';\nimport useStyleSet from '../hooks/useStyleSet';\nimport useStyleToEmotionObject from '../hooks/internal/useStyleToEmotionObject';\n\nconst { useDisabled, useLocalizer } = hooks;\n\nconst ROOT_STYLE = {\n  '&.webchat__upload-button': {\n    display: 'flex',\n    overflow: 'hidden',\n    position: 'relative',\n\n    '& .webchat__upload-button--file-input': {\n      height: 0,\n      width: 0,\n      opacity: 0,\n      position: 'absolute',\n      left: 0,\n      top: 0\n    }\n  }\n};\n\nconst PREVENT_DEFAULT_HANDLER = event => event.preventDefault();\n\nasync function makeThumbnail(file, width, height, contentType, quality) {\n  if (/\\.(gif|jpe?g|png)$/iu.test(file.name)) {\n    try {\n      return await downscaleImageToDataURL(file, width, height, contentType, quality);\n    } catch (error) {\n      console.warn(`Web Chat: Failed to downscale image due to ${error}.`);\n    }\n  }\n}\n\nconst connectUploadButton = (...selectors) =>\n  connectToWebChat(\n    ({\n      disabled,\n      language,\n      sendFiles,\n      styleSet: {\n        options: {\n          enableUploadThumbnail,\n          uploadThumbnailContentType,\n          uploadThumbnailHeight,\n          uploadThumbnailQuality,\n          uploadThumbnailWidth\n        }\n      }\n    }) => ({\n      disabled,\n      language,\n      sendFiles: async files => {\n        if (files && files.length) {\n          // TODO: [P3] We need to find revokeObjectURL on the UI side\n          //       Redux store should not know about the browser environment\n          //       One fix is to use ArrayBuffer instead of object URL, but that would requires change to DirectLineJS\n          sendFiles(\n            await Promise.all(\n              [].map.call(files, async file => ({\n                name: file.name,\n                size: file.size,\n                url: window.URL.createObjectURL(file),\n                ...(enableUploadThumbnail && {\n                  thumbnail: await makeThumbnail(\n                    file,\n                    uploadThumbnailWidth,\n                    uploadThumbnailHeight,\n                    uploadThumbnailContentType,\n                    uploadThumbnailQuality\n                  )\n                })\n              }))\n            )\n          );\n        }\n      }\n    }),\n    ...selectors\n  );\n\ntype UploadButtonProps = {\n  className?: string;\n};\n\nconst UploadButton: FC<UploadButtonProps> = ({ className }) => {\n  const [{ uploadButton: uploadButtonStyleSet }] = useStyleSet();\n  const [disabled] = useDisabled();\n  const inputRef = useRef<HTMLInputElement>();\n  const localize = useLocalizer();\n  const rootClassName = useStyleToEmotionObject()(ROOT_STYLE) + '';\n  const sendFiles = useSendFiles();\n\n  const { current } = inputRef;\n  const uploadFileString = localize('TEXT_INPUT_UPLOAD_BUTTON_ALT');\n\n  const handleClick = useCallback(() => {\n    current && current.click();\n  }, [current]);\n\n  const handleFileChange = useCallback(\n    ({ target: { files } }) => {\n      sendFiles(files);\n\n      if (current) {\n        current.value = null;\n      }\n    },\n    [current, sendFiles]\n  );\n\n  return (\n    <div className={classNames(rootClassName, 'webchat__upload-button', uploadButtonStyleSet + '', className)}>\n      <input\n        aria-disabled={disabled}\n        aria-hidden=\"true\"\n        className=\"webchat__upload-button--file-input\"\n        multiple={true}\n        onChange={disabled ? undefined : handleFileChange}\n        onClick={disabled ? PREVENT_DEFAULT_HANDLER : undefined}\n        readOnly={disabled}\n        ref={inputRef}\n        role=\"button\"\n        tabIndex={-1}\n        type=\"file\"\n      />\n      <IconButton alt={uploadFileString} aria-label={uploadFileString} disabled={disabled} onClick={handleClick}>\n        <AttachmentIcon />\n      </IconButton>\n    </div>\n  );\n};\n\nUploadButton.defaultProps = {\n  className: undefined\n};\n\nUploadButton.propTypes = {\n  className: PropTypes.string\n};\n\nexport default UploadButton;\n\nexport { connectUploadButton };\n"]},"metadata":{},"sourceType":"script"}