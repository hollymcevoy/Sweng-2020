{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport createEmotion from '@emotion/css/create-instance';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport AutoCenter from './AutoCenter';\nimport computeScrollLeft from './computeScrollLeft';\nimport createBasicStyleSet from './createBasicStyleSet';\nimport createCSSKey from './util/createCSSKey';\nimport FunctionContext from './FunctionContext';\nimport getView from './getView';\nimport InternalContext from './InternalContext';\nimport LegacyContext from './LegacyContext';\nimport patchStyleOptions from './patchStyleOptions';\nimport PropsContext from './PropsContext';\nimport useAnimateScrollLeft from './hooks/internal/useAnimateScrollLeft';\nimport useCallbackRefWithSubscribe from './hooks/internal/useCallbackRefWithSubscribe';\nimport useObserveScrollLeft from './hooks/internal/useObserveScrollLeft';\nimport ViewContext from './ViewContext'; // We pool the emotion, so we don't create a new set of <style> for every component and reuse as much as we could.\n\nvar emotionPool = {};\n\nvar Composer = function Composer(_ref) {\n  var children = _ref.children,\n      dir = _ref.dir,\n      height = _ref.height,\n      nonce = _ref.nonce,\n      numItems = _ref.numItems,\n      styleOptions = _ref.styleOptions,\n      styleSet = _ref.styleSet;\n  dir = dir === 'ltr' || dir === 'rtl' ? dir : undefined;\n  var patchedStyleOptions = useMemo(function () {\n    return patchStyleOptions(styleOptions);\n  }, [styleOptions]);\n  var patchedStyleSet = useMemo(function () {\n    return styleSet || createBasicStyleSet(patchedStyleOptions);\n  }, [patchedStyleOptions, styleSet]);\n  var styleSetClassNames = useMemo(function () {\n    var emotion = emotionPool[nonce] || (emotionPool[nonce] = createEmotion({\n      key: \"react-film--css-\".concat(createCSSKey()),\n      nonce: nonce\n    }));\n    return Object.fromEntries(Object.entries(patchedStyleSet).map(function (_ref2) {\n      var _ref3 = _slicedToArray(_ref2, 2),\n          name = _ref3[0],\n          style = _ref3[1];\n\n      return [name, emotion.css(style) + ''];\n    }));\n  }, [nonce, patchedStyleSet]);\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      _ = _useState2[0],\n      forceRender = _useState2[1];\n\n  var itemContainerCallbackRefWithSubscribe = useCallbackRefWithSubscribe();\n  var scrollableCallbackRefWithSubscribe = useCallbackRefWithSubscribe();\n  var scrollLeftRef = useRef(null);\n  var scrollTimeoutRef = useRef();\n  useEffect(function () {\n    return function () {\n      return clearTimeout(scrollTimeoutRef.current);\n    };\n  }, [scrollTimeoutRef]);\n  var scrollTo = useCallback(function (scrollFn) {\n    var view = getView(dir, scrollableCallbackRefWithSubscribe.current, itemContainerCallbackRefWithSubscribe.current, scrollLeftRef.current);\n\n    if (view) {\n      var index = view.index,\n          indexFraction = view.indexFraction;\n      var targetIndex = scrollFn({\n        index: index,\n        indexFraction: indexFraction\n      });\n\n      if (typeof targetIndex === 'number') {\n        scrollLeftRef.current = computeScrollLeft(dir, scrollableCallbackRefWithSubscribe.current, itemContainerCallbackRefWithSubscribe.current, targetIndex);\n        forceRender({});\n      }\n    }\n  }, [dir, forceRender, itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe, scrollLeftRef]);\n  var scrollOneLeft = useCallback(function () {\n    scrollTo(function (_ref4) {\n      var indexFraction = _ref4.indexFraction;\n      return dir === 'rtl' ? Math.floor(indexFraction) + 1 : Math.ceil(indexFraction) - 1;\n    });\n  }, [dir, scrollTo]);\n  var scrollOneRight = useCallback(function () {\n    scrollTo(function (_ref5) {\n      var indexFraction = _ref5.indexFraction;\n      return dir === 'rtl' ? Math.ceil(indexFraction) - 1 : Math.floor(indexFraction) + 1;\n    });\n  }, [dir, scrollTo]);\n  var functionContext = useMemo(function () {\n    return {\n      scrollTo: scrollTo,\n      scrollOneLeft: scrollOneLeft,\n      scrollOneRight: scrollOneRight\n    };\n  }, [scrollTo, scrollOneLeft, scrollOneRight]);\n  var internalContext = useMemo(function () {\n    return {\n      itemContainerCallbackRefWithSubscribe: itemContainerCallbackRefWithSubscribe,\n      scrollableCallbackRefWithSubscribe: scrollableCallbackRefWithSubscribe\n    };\n  }, [itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe]);\n  var propsContext = useMemo(function () {\n    return {\n      dir: dir,\n      height: height,\n      nonce: nonce,\n      numItems: numItems,\n      styleOptions: patchedStyleOptions,\n      styleSetClassNames: styleSetClassNames\n    };\n  }, [dir, height, nonce, numItems, patchedStyleOptions, styleSetClassNames]);\n\n  var _useState3 = useState({\n    index: 0,\n    indexFraction: 0,\n    scrollBarPercentage: '0%',\n    scrollBarWidth: '0%',\n    scrolling: false\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      viewContext = _useState4[0],\n      setViewContext = _useState4[1]; // This will setViewContext and reset the \"scrolling\" flag after a period of time.\n\n\n  var setViewContext2 = useCallback(function (nextViewContext) {\n    setViewContext(nextViewContext);\n    clearTimeout(scrollTimeoutRef.current);\n\n    if (nextViewContext.scrolling) {\n      scrollTimeoutRef.current = setTimeout(function () {\n        return setViewContext(_objectSpread(_objectSpread({}, nextViewContext), {}, {\n          scrolling: false\n        }));\n      }, // eslint-disable-next-line no-magic-numbers\n      500);\n    }\n  }, [scrollTimeoutRef, setViewContext]);\n  var handleScroll = useCallback(function (_ref6) {\n    var scrollBarPercentage = _ref6.fraction,\n        initial = _ref6.initial,\n        scrollBarWidth = _ref6.width;\n    var view = getView(dir, scrollableCallbackRefWithSubscribe.current, itemContainerCallbackRefWithSubscribe.current, scrollLeftRef.current);\n\n    if (view) {\n      var index = view.index,\n          indexFraction = view.indexFraction;\n      setViewContext2({\n        index: index,\n        indexFraction: indexFraction,\n        scrolling: !initial,\n        scrollBarPercentage: scrollBarPercentage,\n        scrollBarWidth: scrollBarWidth\n      });\n    }\n  }, [dir, itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe, scrollLeftRef, setViewContext2]);\n  var handleScrollToEnd = useCallback(function () {\n    scrollLeftRef.current = null;\n    forceRender({});\n  }, [forceRender, scrollLeftRef]);\n  var legacyContext = useMemo(function () {\n    return _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, functionContext), internalContext), propsContext), viewContext);\n  }, [functionContext, internalContext, propsContext, viewContext]);\n  useAnimateScrollLeft(typeof scrollLeftRef.current === 'number' && scrollableCallbackRefWithSubscribe.current, scrollLeftRef.current, handleScrollToEnd);\n  useEffect(function () {\n    return scrollableCallbackRefWithSubscribe.subscribe(function (current) {\n      if (current) {\n        current.addEventListener('pointerdown', handleScrollToEnd, {\n          passive: true\n        });\n        return function () {\n          return current.removeEventListener('pointerdown', handleScrollToEnd);\n        };\n      }\n    });\n  }, [handleScrollToEnd, scrollableCallbackRefWithSubscribe]);\n  useObserveScrollLeft(scrollableCallbackRefWithSubscribe, handleScroll);\n  return /*#__PURE__*/React.createElement(PropsContext.Provider, {\n    value: propsContext\n  }, /*#__PURE__*/React.createElement(InternalContext.Provider, {\n    value: internalContext\n  }, /*#__PURE__*/React.createElement(FunctionContext.Provider, {\n    value: functionContext\n  }, /*#__PURE__*/React.createElement(ViewContext.Provider, {\n    value: viewContext\n  }, /*#__PURE__*/React.createElement(LegacyContext.Provider, {\n    value: legacyContext\n  }, children, patchedStyleOptions.autoCenter && /*#__PURE__*/React.createElement(AutoCenter, null))))));\n};\n\nComposer.defaultProps = {\n  children: undefined,\n  dir: undefined,\n  height: undefined,\n  nonce: undefined,\n  styleOptions: undefined,\n  styleSet: undefined\n};\nComposer.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.element), PropTypes.element]),\n  dir: PropTypes.oneOf(['ltr', 'rtl']),\n  height: PropTypes.number,\n  nonce: PropTypes.string,\n  numItems: PropTypes.number.isRequired,\n  styleOptions: PropTypes.any,\n  styleSet: PropTypes.any\n};\nexport default Composer;","map":{"version":3,"mappings":"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","names":["createEmotion","PropTypes","React","useCallback","useEffect","useMemo","useRef","useState","AutoCenter","computeScrollLeft","createBasicStyleSet","createCSSKey","FunctionContext","getView","InternalContext","LegacyContext","patchStyleOptions","PropsContext","useAnimateScrollLeft","useCallbackRefWithSubscribe","useObserveScrollLeft","ViewContext","emotionPool","Composer","children","dir","height","nonce","numItems","styleOptions","styleSet","undefined","patchedStyleOptions","patchedStyleSet","styleSetClassNames","emotion","key","Object","fromEntries","entries","map","name","style","css","_","forceRender","itemContainerCallbackRefWithSubscribe","scrollableCallbackRefWithSubscribe","scrollLeftRef","scrollTimeoutRef","clearTimeout","current","scrollTo","view","index","indexFraction","targetIndex","scrollFn","scrollOneLeft","Math","floor","ceil","scrollOneRight","functionContext","internalContext","propsContext","scrollBarPercentage","scrollBarWidth","scrolling","viewContext","setViewContext","setViewContext2","nextViewContext","setTimeout","handleScroll","fraction","initial","width","handleScrollToEnd","legacyContext","subscribe","addEventListener","passive","removeEventListener","Provider","value","autoCenter","defaultProps","propTypes","oneOfType","arrayOf","element","oneOf","number","string","isRequired","any"],"sources":["/Users/dylanmurray/Sweng-2022/front/node_modules/react-film/src/Composer.js"],"sourcesContent":["import createEmotion from '@emotion/css/create-instance';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport AutoCenter from './AutoCenter';\nimport computeScrollLeft from './computeScrollLeft';\nimport createBasicStyleSet from './createBasicStyleSet';\nimport createCSSKey from './util/createCSSKey';\nimport FunctionContext from './FunctionContext';\nimport getView from './getView';\nimport InternalContext from './InternalContext';\nimport LegacyContext from './LegacyContext';\nimport patchStyleOptions from './patchStyleOptions';\nimport PropsContext from './PropsContext';\nimport useAnimateScrollLeft from './hooks/internal/useAnimateScrollLeft';\nimport useCallbackRefWithSubscribe from './hooks/internal/useCallbackRefWithSubscribe';\nimport useObserveScrollLeft from './hooks/internal/useObserveScrollLeft';\nimport ViewContext from './ViewContext';\n\n// We pool the emotion, so we don't create a new set of <style> for every component and reuse as much as we could.\nconst emotionPool = {};\n\nconst Composer = ({ children, dir, height, nonce, numItems, styleOptions, styleSet }) => {\n  dir = dir === 'ltr' || dir === 'rtl' ? dir : undefined;\n\n  const patchedStyleOptions = useMemo(() => patchStyleOptions(styleOptions), [styleOptions]);\n  const patchedStyleSet = useMemo(\n    () => styleSet || createBasicStyleSet(patchedStyleOptions),\n    [patchedStyleOptions, styleSet]\n  );\n\n  const styleSetClassNames = useMemo(() => {\n    const emotion =\n      emotionPool[nonce] || (emotionPool[nonce] = createEmotion({ key: `react-film--css-${createCSSKey()}`, nonce }));\n\n    return Object.fromEntries(Object.entries(patchedStyleSet).map(([name, style]) => [name, emotion.css(style) + '']));\n  }, [nonce, patchedStyleSet]);\n\n  const [_, forceRender] = useState();\n  const itemContainerCallbackRefWithSubscribe = useCallbackRefWithSubscribe();\n  const scrollableCallbackRefWithSubscribe = useCallbackRefWithSubscribe();\n  const scrollLeftRef = useRef(null);\n  const scrollTimeoutRef = useRef();\n\n  useEffect(() => () => clearTimeout(scrollTimeoutRef.current), [scrollTimeoutRef]);\n\n  const scrollTo = useCallback(\n    scrollFn => {\n      const view = getView(\n        dir,\n        scrollableCallbackRefWithSubscribe.current,\n        itemContainerCallbackRefWithSubscribe.current,\n        scrollLeftRef.current\n      );\n\n      if (view) {\n        const { index, indexFraction } = view;\n        const targetIndex = scrollFn({ index, indexFraction });\n\n        if (typeof targetIndex === 'number') {\n          scrollLeftRef.current = computeScrollLeft(\n            dir,\n            scrollableCallbackRefWithSubscribe.current,\n            itemContainerCallbackRefWithSubscribe.current,\n            targetIndex\n          );\n          forceRender({});\n        }\n      }\n    },\n    [dir, forceRender, itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe, scrollLeftRef]\n  );\n\n  const scrollOneLeft = useCallback(() => {\n    scrollTo(({ indexFraction }) => (dir === 'rtl' ? Math.floor(indexFraction) + 1 : Math.ceil(indexFraction) - 1));\n  }, [dir, scrollTo]);\n\n  const scrollOneRight = useCallback(() => {\n    scrollTo(({ indexFraction }) => (dir === 'rtl' ? Math.ceil(indexFraction) - 1 : Math.floor(indexFraction) + 1));\n  }, [dir, scrollTo]);\n\n  const functionContext = useMemo(\n    () => ({\n      scrollTo,\n      scrollOneLeft,\n      scrollOneRight\n    }),\n    [scrollTo, scrollOneLeft, scrollOneRight]\n  );\n\n  const internalContext = useMemo(\n    () => ({\n      itemContainerCallbackRefWithSubscribe,\n      scrollableCallbackRefWithSubscribe\n    }),\n    [itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe]\n  );\n\n  const propsContext = useMemo(\n    () => ({ dir, height, nonce, numItems, styleOptions: patchedStyleOptions, styleSetClassNames }),\n    [dir, height, nonce, numItems, patchedStyleOptions, styleSetClassNames]\n  );\n\n  const [viewContext, setViewContext] = useState({\n    index: 0,\n    indexFraction: 0,\n    scrollBarPercentage: '0%',\n    scrollBarWidth: '0%',\n    scrolling: false\n  });\n\n  // This will setViewContext and reset the \"scrolling\" flag after a period of time.\n  const setViewContext2 = useCallback(\n    nextViewContext => {\n      setViewContext(nextViewContext);\n\n      clearTimeout(scrollTimeoutRef.current);\n\n      if (nextViewContext.scrolling) {\n        scrollTimeoutRef.current = setTimeout(\n          () =>\n            setViewContext({\n              ...nextViewContext,\n              scrolling: false\n            }),\n          // eslint-disable-next-line no-magic-numbers\n          500\n        );\n      }\n    },\n    [scrollTimeoutRef, setViewContext]\n  );\n\n  const handleScroll = useCallback(\n    ({ fraction: scrollBarPercentage, initial, width: scrollBarWidth }) => {\n      const view = getView(\n        dir,\n        scrollableCallbackRefWithSubscribe.current,\n        itemContainerCallbackRefWithSubscribe.current,\n        scrollLeftRef.current\n      );\n\n      if (view) {\n        const { index, indexFraction } = view;\n\n        setViewContext2({\n          index,\n          indexFraction,\n          scrolling: !initial,\n          scrollBarPercentage,\n          scrollBarWidth\n        });\n      }\n    },\n    [dir, itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe, scrollLeftRef, setViewContext2]\n  );\n\n  const handleScrollToEnd = useCallback(() => {\n    scrollLeftRef.current = null;\n    forceRender({});\n  }, [forceRender, scrollLeftRef]);\n\n  const legacyContext = useMemo(\n    () => ({\n      ...functionContext,\n      ...internalContext,\n      ...propsContext,\n      ...viewContext\n    }),\n    [functionContext, internalContext, propsContext, viewContext]\n  );\n\n  useAnimateScrollLeft(\n    typeof scrollLeftRef.current === 'number' && scrollableCallbackRefWithSubscribe.current,\n    scrollLeftRef.current,\n    handleScrollToEnd\n  );\n\n  useEffect(\n    () =>\n      scrollableCallbackRefWithSubscribe.subscribe(current => {\n        if (current) {\n          current.addEventListener('pointerdown', handleScrollToEnd, { passive: true });\n\n          return () => current.removeEventListener('pointerdown', handleScrollToEnd);\n        }\n      }),\n    [handleScrollToEnd, scrollableCallbackRefWithSubscribe]\n  );\n\n  useObserveScrollLeft(scrollableCallbackRefWithSubscribe, handleScroll);\n\n  return (\n    <PropsContext.Provider value={propsContext}>\n      <InternalContext.Provider value={internalContext}>\n        <FunctionContext.Provider value={functionContext}>\n          <ViewContext.Provider value={viewContext}>\n            <LegacyContext.Provider value={legacyContext}>\n              {children}\n              {patchedStyleOptions.autoCenter && <AutoCenter />}\n            </LegacyContext.Provider>\n          </ViewContext.Provider>\n        </FunctionContext.Provider>\n      </InternalContext.Provider>\n    </PropsContext.Provider>\n  );\n};\n\nComposer.defaultProps = {\n  children: undefined,\n  dir: undefined,\n  height: undefined,\n  nonce: undefined,\n  styleOptions: undefined,\n  styleSet: undefined\n};\n\nComposer.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.element), PropTypes.element]),\n  dir: PropTypes.oneOf(['ltr', 'rtl']),\n  height: PropTypes.number,\n  nonce: PropTypes.string,\n  numItems: PropTypes.number.isRequired,\n  styleOptions: PropTypes.any,\n  styleSet: PropTypes.any\n};\n\nexport default Composer;\n"]},"metadata":{},"sourceType":"module"}