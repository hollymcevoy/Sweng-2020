{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = clockSkewAdjustment;\n\nvar _incomingActivity = require(\"../actions/incomingActivity\");\n\nvar _setClockSkewAdjustment = require(\"../actions/setClockSkewAdjustment\");\n\nfunction clockSkewAdjustment() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n  var _ref = arguments.length > 1 ? arguments[1] : undefined,\n      payload = _ref.payload,\n      type = _ref.type;\n\n  if (type === _incomingActivity.INCOMING_ACTIVITY) {\n    var _payload$activity = payload.activity,\n        _payload$activity$cha = _payload$activity.channelData;\n    _payload$activity$cha = _payload$activity$cha === void 0 ? {} : _payload$activity$cha;\n    var clientTimestamp = _payload$activity$cha.clientTimestamp,\n        timestamp = _payload$activity.timestamp;\n    var clientSendTime = Date.parse(clientTimestamp);\n    var serverTime = Date.parse(timestamp);\n\n    if (!isNaN(clientSendTime) && !isNaN(serverTime)) {\n      // The adjustment include the latency between the client and the server.\n      // This means, the adjustment is always larger than the actual value.\n      // And it means, after adjustment, client time will be ahead of server time.\n      // And it also means, the user-originated message has higher probability to appear below bot-originated message.\n      // Although it has higher probability, if the user-originated message is still sending (i.e. did not echoback with server timestamp yet),\n      // the insertion-sort logic will put the bot-originated below the user-originated message.\n      state = serverTime - clientSendTime;\n    }\n  } else if (type === _setClockSkewAdjustment.SET_CLOCK_SKEW_ADJUSTMENT) {\n    // Currently, this action is for testing purpose only.\n    state = payload.value;\n  }\n\n  return state;\n}","map":{"version":3,"mappings":";;;;;;;AAAA;;AACA;;AAEe,SAASA,mBAAT,GAA2D;AAAA,MAA9BC,KAA8B,uEAAtB,CAAsB;;AAAA;AAAA,MAAjBC,OAAiB,QAAjBA,OAAiB;AAAA,MAARC,IAAQ,QAARA,IAAQ;;AACxE,MAAIA,IAAI,KAAKC,mCAAb,EAAgC;AAC9B,4BAEIF,OAFJ,CACEG,QADF;AAAA,kDACcC,WADd;AAAAC,+DACiD,EADjD;AAAA,QAC6BC,eAD7B,yBAC6BA,eAD7B;AAAA,QACqDC,SADrD,qBACqDA,SADrD;AAIA,QAAMC,cAAc,GAAGC,IAAI,CAACC,KAALD,CAAWH,eAAXG,CAAvB;AACA,QAAME,UAAU,GAAGF,IAAI,CAACC,KAALD,CAAWF,SAAXE,CAAnB;;AAEA,QAAI,CAACG,KAAK,CAACJ,cAAD,CAAN,IAA0B,CAACI,KAAK,CAACD,UAAD,CAApC,EAAkD;AAChD;AACA;AACA;AACA;AACA;AACA;AAEAZ,WAAK,GAAGY,UAAU,GAAGH,cAArBT;AACD;AAjBH,SAkBO,IAAIE,IAAI,KAAKY,iDAAb,EAAwC;AAC7C;AACAd,SAAK,GAAGC,OAAO,CAACc,KAAhBf;AACD;;AAED,SAAOA,KAAP;AACD","names":["clockSkewAdjustment","state","payload","type","INCOMING_ACTIVITY","activity","channelData","_payload$activity$cha","clientTimestamp","timestamp","clientSendTime","Date","parse","serverTime","isNaN","SET_CLOCK_SKEW_ADJUSTMENT","value"],"sources":["/Users/dylanmurray/Sweng-2022/front/node_modules/botframework-webchat-core/lib/src/reducers/clockSkewAdjustment.js"],"sourcesContent":["import { INCOMING_ACTIVITY } from '../actions/incomingActivity';\nimport { SET_CLOCK_SKEW_ADJUSTMENT } from '../actions/setClockSkewAdjustment';\n\nexport default function clockSkewAdjustment(state = 0, { payload, type }) {\n  if (type === INCOMING_ACTIVITY) {\n    const {\n      activity: { channelData: { clientTimestamp } = {}, timestamp }\n    } = payload;\n\n    const clientSendTime = Date.parse(clientTimestamp);\n    const serverTime = Date.parse(timestamp);\n\n    if (!isNaN(clientSendTime) && !isNaN(serverTime)) {\n      // The adjustment include the latency between the client and the server.\n      // This means, the adjustment is always larger than the actual value.\n      // And it means, after adjustment, client time will be ahead of server time.\n      // And it also means, the user-originated message has higher probability to appear below bot-originated message.\n      // Although it has higher probability, if the user-originated message is still sending (i.e. did not echoback with server timestamp yet),\n      // the insertion-sort logic will put the bot-originated below the user-originated message.\n\n      state = serverTime - clientSendTime;\n    }\n  } else if (type === SET_CLOCK_SKEW_ADJUSTMENT) {\n    // Currently, this action is for testing purpose only.\n    state = payload.value;\n  }\n\n  return state;\n}\n"]},"metadata":{},"sourceType":"script"}