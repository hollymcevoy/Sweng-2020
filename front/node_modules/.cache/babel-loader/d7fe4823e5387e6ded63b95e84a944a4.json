{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _botframeworkWebchatApi = require(\"botframework-webchat-api\");\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Context = _interopRequireDefault(require(\"./private/Context\"));\n\nvar _useActivitiesWithRenderer = _interopRequireDefault(require(\"./private/useActivitiesWithRenderer\"));\n\nvar _useContext = _interopRequireDefault(require(\"./private/useContext\"));\n\nvar _useActivityTreeWithRenderer = _interopRequireDefault(require(\"./private/useActivityTreeWithRenderer\"));\n\nvar _useMemoWithPrevious = _interopRequireDefault(require(\"../../hooks/internal/useMemoWithPrevious\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nvar useActivities = _botframeworkWebchatApi.hooks.useActivities,\n    useCreateActivityRenderer = _botframeworkWebchatApi.hooks.useCreateActivityRenderer;\n\nvar ActivityTreeComposer = function ActivityTreeComposer(_ref) {\n  var children = _ref.children;\n  var existingContext = (0, _useContext.default)(false);\n\n  if (existingContext) {\n    throw new Error('botframework-webchat internal: <ActivityTreeComposer> should not be nested.');\n  }\n\n  var _useActivities = useActivities(),\n      _useActivities2 = _slicedToArray(_useActivities, 1),\n      activities = _useActivities2[0];\n\n  var createActivityRenderer = useCreateActivityRenderer();\n  var activitiesWithRenderer = (0, _useActivitiesWithRenderer.default)(activities, createActivityRenderer);\n  var activityTreeWithRenderer = (0, _useActivityTreeWithRenderer.default)(activitiesWithRenderer);\n  var flattenedActivityTreeWithRenderer = (0, _useMemoWithPrevious.default)(function (prevFlattenedActivityTree) {\n    var nextFlattenedActivityTree = Object.freeze(activityTreeWithRenderer.reduce(function (intermediate, entriesWithSameSender) {\n      return entriesWithSameSender.reduce(function (intermediate, entriesWithSameSenderAndStatus) {\n        return entriesWithSameSenderAndStatus.reduce(function (intermediate, entry) {\n          intermediate.push(entry);\n          return intermediate;\n        }, intermediate);\n      }, intermediate);\n    }, []));\n    return nextFlattenedActivityTree.length === (prevFlattenedActivityTree === null || prevFlattenedActivityTree === void 0 ? void 0 : prevFlattenedActivityTree.length) && nextFlattenedActivityTree.every(function (item, index) {\n      return item === prevFlattenedActivityTree[+index];\n    }) ? prevFlattenedActivityTree : nextFlattenedActivityTree;\n  }, [activityTreeWithRenderer]);\n  var contextValue = (0, _react.useMemo)(function () {\n    return {\n      activityTreeWithRendererState: Object.freeze([activityTreeWithRenderer]),\n      flattenedActivityTreeWithRendererState: Object.freeze([flattenedActivityTreeWithRenderer])\n    };\n  }, [activityTreeWithRenderer, flattenedActivityTreeWithRenderer]);\n  return /*#__PURE__*/_react.default.createElement(_Context.default.Provider, {\n    value: contextValue\n  }, children);\n};\n\nvar _default = ActivityTreeComposer;\nexports.default = _default;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AAOA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,IAAQA,aAAR,GAAqDC,8BAA7CD,aAAR;AAAA,IAAuBE,yBAAvB,GAAqDD,8BAA9BC,yBAAvB;;AAEA,IAAMC,oBAAmD,GAAG,SAAtDA,oBAAsD,OAAkB;AAAA,MAAfC,QAAe,QAAfA,QAAe;AAC5E,MAAMC,eAAe,GAAG,yBAAuB,KAAvB,CAAxB;;AAEA,MAAIA,eAAJ,EAAqB;AACnB,UAAM,IAAIC,KAAJ,CAAU,6EAAV,CAAN;AACD;;AAED,uBAA6CN,aAAa,EAA1D;AAAA;AAAA,MAAOO,UAAP;;AACA,MAAMC,sBAAgD,GAAGN,yBAAyB,EAAlF;AAEA,MAAMO,sBAAsB,GAAG,wCAA0BF,UAA1B,EAAsCC,sBAAtC,CAA/B;AAEA,MAAME,wBAAwB,GAAG,0CAA4BD,sBAA5B,CAAjC;AAEA,MAAME,iCAAiC,GAAG,kCACxC,qCAA6B;AAC3B,QAAMC,yBAAyB,GAAGC,MAAM,CAACC,MAAPD,CAChCH,wBAAwB,CAACK,MAAzBL,CACE,UAACM,YAAD,EAAeC,qBAAf;AAAA,aACEA,qBAAqB,CAACF,MAAtBE,CACE,UAACD,YAAD,EAAeE,8BAAf;AAAA,eACEA,8BAA8B,CAACH,MAA/BG,CAA8D,UAACF,YAAD,EAAeG,KAAf,EAAyB;AACrFH,sBAAY,CAACI,IAAbJ,CAAkBG,KAAlBH;AAEA,iBAAOA,YAAP;AAHF,WAIGA,YAJHE,CADF;AADF,SAOEF,YAPFC,CADF;AADF,OAWE,EAXFP,CADgCG,CAAlC;AAgBA,WAAOD,yBAAyB,CAACS,MAA1BT,MAAqCU,yBAArC,SAAqCA,6BAArC,WAAqCA,GAArC,MAAqCA,4BAAyB,CAAED,MAAhET,KACLA,yBAAyB,CAACW,KAA1BX,CAAgC,UAACY,IAAD,EAAOC,KAAP;AAAA,aAAiBD,IAAI,KAAKF,yBAAyB,CAAC,CAACG,KAAF,CAAnD;AAAhC,MADKb,GAEHU,yBAFGV,GAGHA,yBAHJ;AAlBsC,KAuBxC,CAACF,wBAAD,CAvBwC,CAA1C;AA0BA,MAAMgB,YAAqC,GAAG,oBAC5C;AAAA,WAAO;AACLC,mCAA6B,EAAEd,MAAM,CAACC,MAAPD,CAAc,CAACH,wBAAD,CAAdG,CAD1B;AAELe,4CAAsC,EAAEf,MAAM,CAACC,MAAPD,CAAc,CAACF,iCAAD,CAAdE;AAFnC,KAAP;AAD4C,KAO5C,CAACH,wBAAD,EAA2BC,iCAA3B,CAP4C,CAA9C;AAUA,sBAAOkB,6BAACC,iBAAoBC,QAArB;AAA8BC,SAAK,EAAEN;AAArC,KAAoDtB,QAApD,CAAP;AAlDF;;eAqDeD","names":["useActivities","hooks","useCreateActivityRenderer","ActivityTreeComposer","children","existingContext","Error","activities","createActivityRenderer","activitiesWithRenderer","activityTreeWithRenderer","flattenedActivityTreeWithRenderer","nextFlattenedActivityTree","Object","freeze","reduce","intermediate","entriesWithSameSender","entriesWithSameSenderAndStatus","entry","push","length","prevFlattenedActivityTree","every","item","index","contextValue","activityTreeWithRendererState","flattenedActivityTreeWithRendererState","_react","_Context","Provider","value"],"sources":["/Users/dylanmurray/Sweng-2022/front/node_modules/botframework-webchat-component/lib/src/providers/ActivityTree/ActivityTreeComposer.tsx"],"sourcesContent":["import { hooks } from 'botframework-webchat-api';\nimport React, { useMemo } from 'react';\n\nimport type { ActivityComponentFactory } from 'botframework-webchat-api';\nimport type { DirectLineActivity } from 'botframework-webchat-core';\nimport type { FC, PropsWithChildren } from 'react';\n\nimport { ActivityWithRenderer, ReadonlyActivityTree } from './private/types';\nimport ActivityTreeContext from './private/Context';\nimport useActivitiesWithRenderer from './private/useActivitiesWithRenderer';\nimport useActivityTreeContext from './private/useContext';\nimport useActivityTreeWithRenderer from './private/useActivityTreeWithRenderer';\nimport useMemoWithPrevious from '../../hooks/internal/useMemoWithPrevious';\n\nimport type { ActivityTreeContextType } from './private/Context';\n\ntype ActivityTreeComposerProps = PropsWithChildren<{}>;\n\nconst { useActivities, useCreateActivityRenderer } = hooks;\n\nconst ActivityTreeComposer: FC<ActivityTreeComposerProps> = ({ children }) => {\n  const existingContext = useActivityTreeContext(false);\n\n  if (existingContext) {\n    throw new Error('botframework-webchat internal: <ActivityTreeComposer> should not be nested.');\n  }\n\n  const [activities]: [DirectLineActivity[]] = useActivities();\n  const createActivityRenderer: ActivityComponentFactory = useCreateActivityRenderer();\n\n  const activitiesWithRenderer = useActivitiesWithRenderer(activities, createActivityRenderer);\n\n  const activityTreeWithRenderer = useActivityTreeWithRenderer(activitiesWithRenderer);\n\n  const flattenedActivityTreeWithRenderer = useMemoWithPrevious<Readonly<ActivityWithRenderer[]>>(\n    prevFlattenedActivityTree => {\n      const nextFlattenedActivityTree = Object.freeze(\n        activityTreeWithRenderer.reduce<ActivityWithRenderer[]>(\n          (intermediate, entriesWithSameSender) =>\n            entriesWithSameSender.reduce<ActivityWithRenderer[]>(\n              (intermediate, entriesWithSameSenderAndStatus) =>\n                entriesWithSameSenderAndStatus.reduce<ActivityWithRenderer[]>((intermediate, entry) => {\n                  intermediate.push(entry);\n\n                  return intermediate;\n                }, intermediate),\n              intermediate\n            ),\n          []\n        )\n      );\n\n      return nextFlattenedActivityTree.length === prevFlattenedActivityTree?.length &&\n        nextFlattenedActivityTree.every((item, index) => item === prevFlattenedActivityTree[+index])\n        ? prevFlattenedActivityTree\n        : nextFlattenedActivityTree;\n    },\n    [activityTreeWithRenderer]\n  );\n\n  const contextValue: ActivityTreeContextType = useMemo(\n    () => ({\n      activityTreeWithRendererState: Object.freeze([activityTreeWithRenderer]) as readonly [ReadonlyActivityTree],\n      flattenedActivityTreeWithRendererState: Object.freeze([flattenedActivityTreeWithRenderer]) as readonly [\n        readonly ActivityWithRenderer[]\n      ]\n    }),\n    [activityTreeWithRenderer, flattenedActivityTreeWithRenderer]\n  );\n\n  return <ActivityTreeContext.Provider value={contextValue}>{children}</ActivityTreeContext.Provider>;\n};\n\nexport default ActivityTreeComposer;\n"]},"metadata":{},"sourceType":"script"}